
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../overview-and-tools/">
      
      
        <link rel="next" href="../prompt-engineering/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.7">
    
    
      
        <title>Example uses of AI tools - GEOG3300 and AGRI3003</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-uses-of-ai-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="GEOG3300 and AGRI3003" class="md-header__button md-logo" aria-label="GEOG3300 and AGRI3003" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            GEOG3300 and AGRI3003
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Example uses of AI tools
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="http://geog3300-agri3003.github.io./coursebook" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GEOG3300 and AGRI3003
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../course-outline/" class="md-tabs__link">
        
  
    
  
  Course Outline

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../overview-and-tools/" class="md-tabs__link">
          
  
  AI and LLMs

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../notebooks/week-1_0_llms/" class="md-tabs__link">
          
  
  Notebooks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="GEOG3300 and AGRI3003" class="md-nav__button md-logo" aria-label="GEOG3300 and AGRI3003" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    GEOG3300 and AGRI3003
  </label>
  
    <div class="md-nav__source">
      <a href="http://geog3300-agri3003.github.io./coursebook" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GEOG3300 and AGRI3003
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../course-outline/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Course Outline
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    AI and LLMs
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            AI and LLMs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview-and-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using AI for spatial and agricultural data analysis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Example uses of AI tools
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Example uses of AI tools
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ai-for-gis" class="md-nav__link">
    <span class="md-ellipsis">
      AI for GIS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ai-for-programming-and-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      AI for programming and data analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ai-for-literature-reviews-studying-thinking-and-writing" class="md-nav__link">
    <span class="md-ellipsis">
      AI for literature reviews, studying, thinking and writing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../prompt-engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../verifying-and-checking-ai-responses/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verifying and checking AI outputs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../responsible-use-of-ai/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Responsible use of AI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hugging-face-and-colab-setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running your own LLMs: Hugging Face and Google Colab setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-1_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LLM activity creating an AI agricultural assistant
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Notebooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-1_0_llms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 1 0 llms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-1_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 1 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-1_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 1 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-1_practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 1 practice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-2_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 2 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-2_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 2 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-2_practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 2 practice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-3_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 3 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-3_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 3 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-3_practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 3 practice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-3_cloud_native_geospatial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 3 cloud native geospatial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-4_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 4 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-4_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 4 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-4_practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 4 practice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-5_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 5 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-5_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 5 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-6_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 6 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-6_2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 6 2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-7_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 7 1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../notebooks/week-8_1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Week 8 1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ai-for-gis" class="md-nav__link">
    <span class="md-ellipsis">
      AI for GIS
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ai-for-programming-and-data-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      AI for programming and data analysis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ai-for-literature-reviews-studying-thinking-and-writing" class="md-nav__link">
    <span class="md-ellipsis">
      AI for literature reviews, studying, thinking and writing
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="example-uses-of-ai-tools">Example uses of AI tools<a class="headerlink" href="#example-uses-of-ai-tools" title="Permanent link">&para;</a></h1>
<p>These are some examples of prompts and ways to use AI tools. They are designed to give you ideas of how to use AI tools to support and enhance your studies. </p>
<h2 id="ai-for-gis">AI for GIS<a class="headerlink" href="#ai-for-gis" title="Permanent link">&para;</a></h2>
<p><strong>Use the LLM to help you identify GIS operations to solve geospatial problems</strong></p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I am a geospatial analyst working for a precision agriculture technology consultancy. I have two drone images of the same field captured on different dates. How can I co-register these images for accurate within-field change analysis? </p>
<p>Can you consider the strengths and weaknesses of different co-registration methods and outline software tools that support these operations?</p>
<div class="admonition tip">
<p class="admonition-title">Use thinking models</p>
<p>This task requires identifying different co-registration methods and reasoning about their strengths and weakness. "Thinking" models which implement chain-of-thought reasoning and reflect on generated responses are useful for these comparative tasks. The model's "thinking" process will provide a slower and more thoughtful consideration of each co-registration method. </p>
</div>
<details class="note">
<summary>Response (Gemini 2.0 Flash Thinking)</summary>
<p>Co-registering drone images captured on different dates is crucial for accurate within-field change analysis in precision agriculture. Misalignment can lead to false change detection, skewing your analysis of vegetation health, growth patterns, or treatment effectiveness. Let's explore the methods, their strengths and weaknesses, and relevant software tools.</p>
<p>Co-registration Methods for Drone Imagery</p>
<p>Co-registration aims to spatially align two or more images so that corresponding pixels represent the same ground location. For drone images, especially those of agricultural fields, several methods are applicable, broadly categorized as:</p>
<ol>
<li>
<p>Ground Control Point (GCP) Based Co-registration:</p>
</li>
<li>
<p>Method Description: This is often considered the most accurate and reliable method, especially when high precision is required. It relies on accurately measured ground control points (GCPs) visible in both drone images. GCPs are physical markers placed in the field with known coordinates (typically obtained using a survey-grade GPS or RTK). During image processing, these GCPs are identified in each image and used to geometrically transform one image to match the spatial reference of the other.</p>
</li>
</ol>
<p>Strengths:</p>
<ul>
<li>High Accuracy: When GCPs are accurately surveyed and well-distributed, this method provides the highest possible geometric accuracy, crucial for precise change detection.</li>
<li>Reliability: GCPs provide absolute spatial reference, making the co-registration robust and less susceptible to image distortions or content changes.</li>
<li>Control over Transformation: You can select the type of transformation (e.g., rigid, affine, polynomial) based on the expected distortions and field characteristics.</li>
</ul>
<p>Weaknesses:</p>
<ul>
<li>Labor-Intensive: Requires physical placement and accurate surveying of GCPs, which can be time-consuming and expensive.
Field Access Required: Necessitates access to the field on both image acquisition dates to establish or verify GCP locations (if permanent GCPs are not used).</li>
<li>GCP Visibility: GCPs must be clearly visible in both drone images, which may require careful marker design and placement, and could be obstructed by vegetation in later image dates.</li>
<li>
<p>Not always practical for large areas or repeat visits: Placing and surveying GCPs for every image acquisition, especially for large fields or frequent monitoring, can become logistically challenging.</p>
</li>
<li>
<p>Feature-Based (Image-to-Image) Co-registration:</p>
</li>
<li>
<p>Method Description: This method directly aligns images based on automatically detected and matched features within the images themselves. It doesn't rely on external GCPs. Common techniques include:</p>
</li>
<li>Feature Detection and Matching: Algorithms like SIFT (Scale-Invariant Feature Transform), SURF (Speeded-Up Robust Features), or ORB (Oriented FAST and Rotated BRIEF) are used to identify distinctive features (keypoints) in both images. These features are then matched based on their descriptors.</li>
<li>Transformation Estimation: Once enough feature matches are found, a geometric transformation (e.g., affine, projective) is estimated that best aligns the matched features between the images. Robust estimators (like RANSAC) are often used to minimize the influence of outlier matches.</li>
<li>Image Resampling: One image is then resampled and warped according to the estimated transformation to align with the reference image.</li>
</ul>
<p>Strengths:</p>
<ul>
<li>GCP-Free: Eliminates the need for GCPs, significantly reducing fieldwork and time.
Automated: The process is largely automated, making it more efficient for large datasets.</li>
<li>Suitable for areas without GCPs: Applicable even if GCPs were not collected during image acquisition or are impractical.</li>
<li>Can adapt to image content changes: Feature-based methods can sometimes be more resilient to slight changes in scene content (e.g., vegetation growth) compared to methods solely relying on initial georeferencing.</li>
</ul>
<p>Weaknesses:</p>
<ul>
<li>Lower Accuracy (generally): Typically less accurate than GCP-based methods, as image features are not as spatially precise as surveyed GCPs. Accuracy depends heavily on image quality, feature distinctiveness, and the quality of feature matching.</li>
<li>Potential for Misregistration: In areas with repetitive patterns, textureless surfaces, or significant changes between image dates (e.g., major crop growth, tillage), feature matching can be unreliable, leading to misregistration.</li>
<li>Transformation Limitations: Feature-based methods often assume a global transformation model, which might not perfectly correct for localized distortions present in drone imagery (especially from lower-cost drones or in windy conditions).</li>
<li>
<p>Parameter Tuning: Feature detection and matching algorithms often have parameters that need to be tuned for optimal performance based on image characteristics.</p>
</li>
<li>
<p>Sensor Model/Direct Georeferencing Based Co-registration:</p>
</li>
<li>
<p>Method Description: Modern drones often incorporate high-precision GPS/GNSS and Inertial Measurement Units (IMUs) for direct georeferencing. This means the drone's position and orientation are recorded directly during flight. If both datasets were processed using direct georeferencing (or PPK/RTK post-processing), the images should ideally be already well-aligned based on the sensor model and trajectory data. Co-registration in this case becomes more about fine-tuning.</p>
</li>
</ul>
<p>Strengths:</p>
<ul>
<li>Fast and Efficient: If direct georeferencing is accurate, co-registration can be very fast as the initial alignment is already good.</li>
<li>Reduced or Eliminated GCPs (potentially): High-accuracy direct georeferencing (like PPK/RTK) can significantly reduce or even eliminate the need for GCPs in some cases, though GCPs are still recommended for validation and to further improve accuracy, especially for large projects or demanding accuracy requirements.
Good Starting Point: Provides a good initial geometric correction, simplifying further refinement if needed.</li>
</ul>
<p>Weaknesses:</p>
<ul>
<li>Accuracy Dependent on Sensor Quality: The accuracy is directly tied to the quality of the drone's GPS/IMU system and the processing method (direct georeferencing vs. PPK/RTK). Lower-cost drones might have less accurate sensors.</li>
<li>Atmospheric and Environmental Factors: GPS signals can be affected by atmospheric conditions and obstructions.
Still may require refinement: Even with direct georeferencing, there can be residual distortions and misalignments. Fine-tuning using feature-based methods or minimal GCPs might still be beneficial for very high-accuracy change analysis.</li>
<li>Reliability of Initial Processing: Relies on the accuracy and quality of the initial photogrammetric processing steps that generated the orthomosaics or orthophotos in the first place.</li>
</ul>
<p>Choosing the Right Method:</p>
<p>The best co-registration method depends on several factors:</p>
<ul>
<li>Required Accuracy: For very precise within-field change analysis (e.g., centimeter-level accuracy), GCP-based methods are generally preferred. For less stringent accuracy requirements or preliminary assessments, feature-based methods or direct georeferencing refinement might suffice.</li>
<li>Availability of GCPs: If GCPs were collected and accurately surveyed, GCP-based methods are a strong choice. If not, you'll need to rely on feature-based or sensor model approaches.</li>
<li>Drone and Sensor Quality: Drones with high-precision GPS/IMU systems and processed with PPK/RTK offer better initial georeferencing, potentially reducing the need for extensive co-registration.</li>
<li>Image Quality and Content: Image quality (resolution, sharpness, radiometry) and the presence of distinct features significantly impact the success of feature-based methods. Changes in vegetation or scene content between dates can also affect feature matching.</li>
<li>Time and Resource Constraints: GCP-based methods are more time and resource-intensive. Feature-based and direct georeferencing refinement are typically faster and require less fieldwork.</li>
</ul>
<p>Software Tools for Co-registration</p>
<p>Many geospatial software packages support image co-registration. Here are some prominent examples, categorized by type:</p>
<p>GIS and Remote Sensing Software:</p>
<p>ArcGIS (Esri):</p>
<ul>
<li>Georeferencing Toolset: Robust tools for GCP-based georeferencing, including various transformation models, residual analysis, and accuracy assessment.</li>
<li>Image Analysis Extension: Supports feature-based image registration using techniques like automatic tie point generation and image warping.</li>
<li>Workflow: Can integrate GCP-based and feature-based methods.</li>
<li>Pros: Widely used in geospatial industry, comprehensive tools, excellent visualization and analysis capabilities.</li>
<li>Cons: Commercial software, can be expensive, complex interface for some users.</li>
</ul>
<p>QGIS (Open Source):</p>
<ul>
<li>Georeferencer GDAL plugin: For GCP-based georeferencing, supports various transformations, allows GCP management, and accuracy assessment.</li>
<li>Plugins like "Feature Alignment" or scripting with Python/GDAL/OpenCV: Can be used to implement feature-based co-registration (more advanced, might require programming skills).</li>
<li>Pros: Free and open source, versatile, large community support, integrates well with other geospatial libraries.</li>
<li>Cons: Feature-based tools might require more manual setup and scripting compared to commercial software, potentially steeper learning curve for complex tasks.</li>
</ul>
<p>ENVI (Harris Geospatial Solutions):</p>
<ul>
<li>Image Registration Module: Dedicated module for both GCP-based and feature-based image registration. Offers automatic tie point generation, various transformation models, and accuracy metrics.</li>
<li>Pros: Specialized for remote sensing image analysis, powerful image processing capabilities, good for handling large datasets.</li>
<li>Cons: Commercial software, can be expensive, interface might be less intuitive for general GIS tasks compared to ArcGIS.</li>
</ul>
<p>ERDAS IMAGINE (Hexagon Geospatial):</p>
<ul>
<li>Geometric Correction Module: Provides tools for GCP-based georeferencing and image registration, including various transformation options and accuracy reporting.</li>
<li>Auto Sync Module: Supports automated feature-based image registration.</li>
<li>Pros: Long-standing remote sensing software with strong image processing and photogrammetry capabilities.</li>
<li>Cons: Commercial software, can be expensive, interface can be perceived as older and less modern compared to some newer software.</li>
</ul>
<p>Photogrammetry Software (Often used for drone data processing):</p>
<p>Agisoft Metashape (formerly PhotoScan):</p>
<ul>
<li>Alignment Step: As part of the photogrammetric workflow, Metashape inherently performs image alignment, which can be refined with GCPs or tie points. It's excellent at feature-based alignment for orthomosaic generation and can be used for co-registration of already orthorectified images.</li>
<li>Pros: Widely used for drone data processing, strong feature-based alignment capabilities, good for generating orthomosaics and DEMs.</li>
<li>Cons: Commercial software, primarily focused on 3D reconstruction workflow, dedicated co-registration tools might be less extensive compared to pure GIS/RS software for specific registration tasks.</li>
</ul>
<p>Pix4Dmapper/Pix4Dmatic:</p>
<ul>
<li>Similar to Metashape: Pix4D products also perform robust image alignment as part of their processing pipeline. Can be used for co-registration and refinement with GCPs or manual tie points.</li>
<li>Pros: Popular drone data processing software, good for large datasets, Pix4Dmatic is designed for faster processing of very large datasets.</li>
<li>Cons: Commercial software, primarily focused on 3D reconstruction workflow, dedicated co-registration tools might be within the broader processing flow rather than standalone tools.</li>
</ul>
<p>Programming Libraries (For Custom Solutions and Automation):</p>
<p>GDAL/OGR (Geospatial Data Abstraction Library):</p>
<ul>
<li>Command-line tools and libraries (C++, Python, etc.): Powerful for geospatial data manipulation, including raster warping and transformation. Can be used to implement GCP-based and feature-based co-registration workflows through scripting.</li>
<li>Pros: Open source, very versatile, widely used in geospatial development, excellent for batch processing and automation.</li>
<li>Cons: Requires programming skills, might have a steeper learning curve for users without programming background, requires assembling workflows from individual functions.</li>
</ul>
<p>OpenCV (Open Source Computer Vision Library):
* Python, C++, Java interfaces: Extensive library for computer vision tasks, including feature detection, feature matching, and image transformations. Can be used to build custom feature-based co-registration workflows.
* Pros: Open source, highly optimized for computer vision tasks, large community, very flexible for custom algorithm development.
* Cons: Requires programming skills, focused on computer vision primitives, requires more effort to build complete geospatial workflows compared to dedicated GIS/RS software.</p>
<p>Workflow Outline for Co-registration and Change Analysis:</p>
<p>Pre-processing:</p>
<ul>
<li>Radiometric Calibration: Ensure both images are radiometrically calibrated to minimize the effects of sensor variations and atmospheric conditions on change detection.</li>
<li>Orthorectification: If your images are not already orthorectified, process them to generate orthomosaics/orthophotos. This is crucial for accurate geometric alignment and spatial measurements.</li>
<li>Resolution Matching (Optional): If the images have significantly different resolutions, you might consider resampling the higher-resolution image to match the lower resolution to avoid artifacts during change analysis.</li>
<li>Choose Co-registration Method: Select the most appropriate method based on accuracy requirements, data availability (GCPs), drone/sensor quality, and time constraints (as discussed earlier).</li>
</ul>
<p>Perform Co-registration:</p>
<p>GCP-Based:</p>
<ul>
<li>Load GCP coordinates into the software.</li>
<li>Identify and mark GCPs in both images.</li>
<li>Select a suitable transformation model.</li>
<li>Run the georeferencing/co-registration tool.</li>
</ul>
<p>Feature-Based:</p>
<ul>
<li>Select feature detection and matching algorithms in the software.</li>
<li>Run the automatic feature matching process.</li>
<li>Review and refine matches (remove outliers if necessary).</li>
<li>Select a transformation model and run the image registration tool.</li>
</ul>
<p>Sensor Model Refinement:</p>
<p>If direct georeferencing was used initially, load both orthomosaics into software.
Consider using feature-based refinement or adding a few well-distributed check points (even without full GCP survey) to fine-tune the alignment.</p>
<p>Accuracy Assessment:</p>
<ul>
<li>Visual Inspection: Overlay the co-registered images and visually inspect for misalignment, especially in areas with distinct features. "Flicker" or "swipe" tools in GIS software are helpful for this.</li>
</ul>
<p>Quantitative Accuracy Assessment:</p>
<ul>
<li>RMS Error (RMSE): If using GCPs or check points, examine the Root Mean Square Error (RMSE) reported by the software. Lower RMSE values indicate better accuracy.</li>
<li>Check Points (Independent): If possible, use independent check points (locations not used in the co-registration process) to assess accuracy.</li>
<li>Feature Overlay Analysis: Examine the alignment of features like field boundaries, roads, or drainage ditches after co-registration.</li>
<li>Change Analysis: Once you are satisfied with the co-registration accuracy:</li>
</ul>
<p>Perform your desired change analysis: This could involve:</p>
<ul>
<li>Band Math/Vegetation Indices Differencing: Calculate differences in NDVI, other vegetation indices, or individual bands to highlight changes in vegetation health, biomass, etc.</li>
<li>Image Classification Change Detection: Classify land cover types in both images and analyze changes in classes over time.</li>
<li>Object-Based Change Detection: Identify and track changes in individual objects within the field.</li>
<li>Interpretation and Validation:  Interpret the change analysis results in the context of agricultural practices, environmental conditions, and your specific research questions. Validate your findings with field observations or other data sources if possible.</li>
</ul>
<p>Key Considerations for Precision Agriculture:</p>
<ul>
<li>Within-Field Variability: Agricultural fields often exhibit high within-field variability. Accurate co-registration is essential to ensure that change analysis truly reflects temporal changes and not just spatial misalignment.</li>
<li>Sub-Pixel Accuracy: For many precision agriculture applications, achieving sub-pixel co-registration accuracy is desirable to minimize noise and maximize the reliability of change detection.</li>
<li>Documentation: Document your co-registration method, parameters, accuracy assessment results, and software tools used for reproducibility and transparency.</li>
</ul>
<p>By carefully selecting the appropriate co-registration method, utilizing robust software tools, and rigorously assessing accuracy, you can effectively co-register your drone images and perform reliable within-field change analysis for precision agriculture applications. Remember to consider the strengths and weaknesses of each method in the context of your specific project requirements and data characteristics.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I have a series of spatial points with crop yield measurements from a yield monitor on a harvester as a CSV file, a GeoTIFF file storing monthly NDVI values and GeoPackage file storing a field boundary. </p>
<p>What GIS operations do I need to perform to select all the yield monitor points within the field and to extract the monthly NDVI time-series at each point.</p>
<div class="admonition tip">
<p class="admonition-title">Help the model generate more accurate and relevant responses</p>
<p>The more detail you provide the LLM in your prompt, the more closely the LLM will engage with the specifics of your task and generate a more relevant and useful response. </p>
<p>The prompt above is a good start as it describes the formats of the input data. However, it could be improved by specifying what output format you'd like (e.g. structure of a table, visualisations or file format to save the data). You could also ask the model to provide a step by step explantion to ensure it considers each step in the workflow in-turn.</p>
</div>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<p>Load Data</p>
<ul>
<li>Yield Monitor Data: Load the CSV file containing the yield monitor data into a GeoDataFrame. Ensure the data includes latitude and longitude columns or a geometry column representing the point locations.</li>
<li>NDVI Data: Load the GeoTIFF file containing monthly NDVI values as a raster dataset.</li>
<li>Field Boundary: Load the GeoPackage file and extract the field boundary polygon.</li>
</ul>
<p>Spatial Selection</p>
<ul>
<li>Reproject (if necessary): Ensure that the yield monitor data and the field boundary are in the same coordinate reference system (CRS). If not, reproject one of the datasets to match the other.</li>
<li>Spatial Join: Perform a spatial join between the yield monitor points and the field boundary polygon. Use the 'intersects' or 'within' spatial predicate to select only the points that fall within the field boundary. This will create a new GeoDataFrame containing only the yield points within the field.</li>
</ul>
<p>Time-Series Extraction</p>
<ul>
<li>Reproject (if necessary): Ensure that the yield monitor points (now filtered to be within the field) and the NDVI raster are in the same CRS. If not, reproject one of the datasets to match the other.</li>
<li>Extract NDVI Values: For each point in the filtered yield monitor data, extract the corresponding NDVI value from each monthly layer in the NDVI raster. This will create a new DataFrame or extend the existing GeoDataFrame with columns representing the NDVI values for each month.</li>
</ul>
<p>Python Code Example (using geopandas and rasterio)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span> <span class="nn">rasterio</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Load data</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">yield_data</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;yield_monitor.csv&quot;</span><span class="p">)</span>  <span class="c1"># Replace with your file name</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="n">ndvi_raster</span> <span class="o">=</span> <span class="n">rasterio</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;monthly_ndvi.tif&quot;</span><span class="p">)</span>  <span class="c1"># Replace with your file name</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">field_boundary</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s2">&quot;field_boundary.gpkg&quot;</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s2">&quot;field_layer&quot;</span><span class="p">)</span>  <span class="c1"># Replace with your file name and layer name</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="c1"># Reproject if necessary (ensure yield_data and field_boundary have the same CRS)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">yield_data</span> <span class="o">=</span> <span class="n">yield_data</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">field_boundary</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="c1"># Spatial join</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">yield_within_field</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">sjoin</span><span class="p">(</span><span class="n">yield_data</span><span class="p">,</span> <span class="n">field_boundary</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">,</span> <span class="n">predicate</span><span class="o">=</span><span class="s2">&quot;intersects&quot;</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="c1"># Reproject if necessary (ensure yield_within_field and ndvi_raster have the same CRS)</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="n">yield_within_field</span> <span class="o">=</span> <span class="n">yield_within_field</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">ndvi_raster</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="c1"># Extract NDVI time-series</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ndvi_raster</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>    <span class="n">ndvi_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">ndvi_raster</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">yield_within_field</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">yield_within_field</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">y</span><span class="p">)]</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>    <span class="n">yield_within_field</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;NDVI_month_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndvi_values</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="c1"># Save or use the resulting GeoDataFrame</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="nb">print</span><span class="p">(</span><span class="n">yield_within_field</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></code></pre></div>
<p>Explanation</p>
<ul>
<li>The code first loads the yield data, NDVI raster, and field boundary into appropriate data structures.</li>
<li>It then reprojects the yield data to match the CRS of the field boundary (if necessary) and performs a spatial join to select points within the field.</li>
<li>Next, it reprojects the filtered yield data to match the CRS of the NDVI raster (if necessary).</li>
<li>It iterates through each band (month) in the NDVI raster, extracts the NDVI value at each point location, and adds it as a new column in the GeoDataFrame.</li>
<li>The resulting GeoDataFrame contains the yield data for points within the field, along with their corresponding monthly NDVI values.</li>
</ul>
<p>Additional Considerations</p>
<ul>
<li>Point in Polygon: The spatial join operation effectively performs a "point-in-polygon" test to determine which points are inside the field boundary.</li>
<li>Raster Value Extraction: The code extracts the NDVI value at the exact pixel location of each point. You can explore other extraction methods (e.g., bilinear interpolation) if needed.</li>
<li>Data Cleaning: Check for missing or invalid values in both the yield data and the NDVI time-series.</li>
<li>Analysis: Once you have the combined data, you can perform further analysis, such as correlating yield with NDVI trends or building predictive models.</li>
</ul>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I have a dataset of tree locations represented as spatial points and field boundaries in a separate polygon layer. How can I count the number of trees within each field? </p>
<p>Please provide a step by step explanation. </p>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<p>You can count the number of trees within each field using a spatial join or intersection operation.  Here's a step-by-step explanation, applicable to most GIS software (like QGIS, ArcGIS, or PostGIS):</p>
<p>Prepare your data:</p>
<ul>
<li>Tree Points: Ensure your tree locations are in a point layer (e.g., shapefile, GeoJSON, or a spatial database table). Each point should represent a single tree. The crucial part is that these points have a defined coordinate system (CRS).</li>
<li>Field Polygons: Make sure your field boundaries are in a polygon layer (e.g., shapefile, GeoJSON, or a spatial database table). Each polygon represents a single field. This layer must be in the same coordinate system as your tree point layer. If they aren't, you'll need to reproject one of the layers to match the other before proceeding. Consistent CRS is absolutely essential for accurate spatial analysis.</li>
</ul>
<p>Perform the Spatial Join (or Intersection):</p>
<p>This is the core step. The specific tool name might vary slightly depending on your GIS software, but the concept is the same.  You're essentially asking the GIS to determine which trees fall within which fields.</p>
<p>QGIS: Use the "Join attributes by location" tool (found in the Vector menu under "Spatial join").</p>
<ul>
<li>Target layer: Your field polygons.</li>
<li>Join layer: Your tree points.</li>
<li>Join type: "One to many" (because one field can contain multiple trees).</li>
<li>Output layer: A new polygon layer. This new layer will have all the attributes of your original field polygons, plus information about the trees within each field (specifically, the count).</li>
</ul>
<p>ArcGIS: Use the "Spatial Join" tool.</p>
<ul>
<li>Target Features: Your field polygons.</li>
<li>Join Features: Your tree points.</li>
<li>Join Type: "One to Many".</li>
<li>Match Option: "Within" (or "Contains," depending on how you define "within").</li>
<li>Output Feature Class: A new feature class (polygon layer).</li>
</ul>
<p>PostGIS (SQL): Use a spatial query with the ST_Contains or ST_Intersects function. Here's a basic example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>CREATE TABLE field_tree_counts AS
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>SELECT
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    fields.field_id,  -- Replace with your field&#39;s unique ID column
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    fields.field_name, -- Replace with your field&#39;s name column (optional)
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    COUNT(trees.tree_id) AS tree_count -- Replace with your tree&#39;s unique ID column
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>FROM
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>    fields_table AS fields, -- Replace with your fields table name
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    trees_table AS trees  -- Replace with your trees table name
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>WHERE
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    ST_Contains(fields.geom, trees.geom) -- Or ST_Intersects(fields.geom, trees.geom)
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>GROUP BY
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    fields.field_id, fields.field_name; -- Group by field ID and name
</span></code></pre></div>
<p>View the Results:</p>
<p>The output from the spatial join will be a new polygon layer. This layer will have the attributes of your original field polygons. Crucially, it will also have a new attribute (usually named something like tree_count or COUNT) that represents the number of trees within each field.</p>
<p>Open the attribute table of this new layer to see the counts.</p>
<p>(Optional) Further Analysis:</p>
<p>You can now use this new layer for further analysis, like calculating statistics (average tree density per field), visualizing the results (e.g., choropleth maps showing tree density), or exporting the data to other formats.</p>
<p>Key Considerations:</p>
<ul>
<li>Coordinate Systems (CRS): Double-check that your tree and field data are in the same CRS. This is the most common source of errors in spatial analysis.</li>
<li>"Within" vs. "Contains": In some GIS software, you might have the option of "Within" or "Contains." "Within" means the tree's entire geometry must be within the field. "Contains" means the field contains the tree. Usually, "Within" is the more appropriate choice for this type of analysis.</li>
<li>Data Cleaning: Before performing the spatial join, it's a good idea to check your data for any errors, like overlapping polygons or invalid geometries. Cleaning your data can prevent unexpected results.</li>
<li>Performance: If you have a very large dataset, the spatial join can be computationally intensive. Consider using spatial indexing or optimizing your query (if using a spatial database) to improve performance.</li>
</ul>
<p>By following these steps, you should be able to accurately count the number of trees within each field in your dataset.  Remember to adapt the instructions slightly depending on the specific GIS software you are using.</p>
</details>
</div>
<p><strong>Describe a geospatial problem and your datasets and instruct the LLM to give you detailed instructions on how to solve the problem using desktop GIS (e.g. QGIS / ArcGIS)</strong></p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I have a series of spatial points with crop yield measurements from a yield monitor on a harvester as a CSV file, a GeoTIFF file storing monthly NDVI values and GeoPackage file storing a field boundary. I need to select all the yield monitor points within the field and to extract the monthly NDVI time-series at each point. </p>
<p>Can you provide detailed step-by-step instructions to do this using QGIS?</p>
<details>
<summary>Response (Gemini 2.0 Flash)</summary>
<p>Here's a detailed step-by-step guide on how to select yield points within a field boundary and extract monthly NDVI time series at each point using QGIS:</p>
<p>Load Your Data:</p>
<p>Yield Points (CSV):</p>
<ul>
<li>Open QGIS.</li>
<li>Go to Layer -&gt; Add Layer -&gt; Add Delimited Text Layer.</li>
<li>Browse to your CSV file.</li>
<li>Ensure the correct delimiter (comma in your case) is selected.</li>
<li>Specify the X and Y fields (longitude and latitude).</li>
<li>Set the CRS (Coordinate Reference System) to match your other data. This is crucial. If you're unsure, check the properties of your GeoTIFF or field boundary. Common CRS for agricultural data include UTM zones or geographic coordinates (WGS 84).</li>
<li>Click Add. The points should now appear on the map.</li>
</ul>
<p>NDVI GeoTIFF:</p>
<ul>
<li>Go to Layer -&gt; Add Layer -&gt; Add Raster Layer.</li>
<li>Browse to your GeoTIFF file.</li>
<li>Click Add. The NDVI raster should now be displayed. It's likely that you will need to repeat this step for each monthly NDVI GeoTIFF you want to extract data from.</li>
</ul>
<p>Field Boundary (GeoPackage):</p>
<ul>
<li>Go to Layer -&gt; Add Layer -&gt; Add Vector Layer.</li>
<li>Browse to your GeoPackage file.</li>
<li>Select the field boundary layer.</li>
<li>Click Add. The field boundary should now be visible.</li>
</ul>
<p>Select Yield Points within the Field:</p>
<ul>
<li>Go to Vector -&gt; Geoprocessing Tools -&gt; Clip.</li>
<li>Input layer: Your yield points layer.</li>
<li>Overlay layer: Your field boundary layer.</li>
<li>Output layer: Choose a location and name for the new clipped points layer (e.g., yield_points_in_field.shp).</li>
<li>Click Run. This will create a new point layer containing only the yield points that fall within the field boundary.</li>
</ul>
<p>Extract NDVI Values at Each Point (for one month):</p>
<ul>
<li>Go to Plugins -&gt; Manage and Install Plugins.</li>
<li>Search for and install the "Point sampling tool" plugin if you don't have it already.</li>
<li>Go to Plugins -&gt; Point sampling tool -&gt; Point sampling tool.</li>
<li>Input point layer: Your clipped yield points layer (yield_points_in_field).</li>
<li>Input raster layer: Your NDVI GeoTIFF (for the specific month).</li>
<li>Output layer: Choose a location and name for the output (e.g., yield_points_ndvi_month1.shp).</li>
<li>Click Run. This will create a new point layer. The attribute table of this new layer will contain the NDVI value (from the raster) at each point. The name of the new field may be the same as the raster file name.</li>
</ul>
<p>Repeat for all months:</p>
<p>Repeat step 3 for each of your monthly NDVI GeoTIFF files. Make sure to create a new output file for each month (e.g., yield_points_ndvi_month2.shp, yield_points_ndvi_month3.shp, etc.).</p>
<p>Combine Monthly Data (Optional but usually needed):</p>
<p>You now have multiple point layers, each containing the NDVI values for a different month.  To create a single table with the time series data, you can use the "Join attributes by location" tool (Vector -&gt; Data Management Tools -&gt; Join attributes by location) or the "Merge vector layers" tool (Vector -&gt; Data Management Tools -&gt; Merge vector layers).  The latter is easier to use, but requires some data manipulation to get it into a time series format.</p>
<p>Using "Merge vector layers" (Recommended):</p>
<ul>
<li>Merge all the monthly point layers into a single layer.</li>
<li>Open the attribute table of the merged layer. You'll now have all the monthly NDVI values as different columns.</li>
<li>Export the attribute table to a CSV file. This will be easier to work with for time series analysis.</li>
<li>Using "Join attributes by location" (More complex):</li>
<li>You can join each month's NDVI data to the original yield points layer. This will create separate layers for each month.</li>
<li>You can then merge these layers or export the attribute tables to create your time series dataset.</li>
</ul>
<p>Time Series Analysis (Outside QGIS):</p>
<p>Once you have your data in a CSV file, you'll likely want to perform time series analysis or visualization. You can use tools like R, Python (with libraries like Pandas and Matplotlib), or even Excel for this.</p>
<p>Important Considerations:</p>
<ul>
<li>Coordinate Systems (CRS): Absolutely critical. Make sure all your layers (yield points, NDVI rasters, and field boundary) are in the same CRS. If they're not, you must reproject them before doing any spatial analysis.</li>
<li>NDVI Raster Alignment: Ensure your monthly NDVI rasters align spatially. If they are slightly misaligned, you might get incorrect NDVI values at your points.</li>
<li>Data Volume: If you have a very large dataset, these operations might take some time. Consider using a spatial database (like PostGIS) for better performance.</li>
<li>QGIS Versions: The menu options might be slightly different depending on your QGIS version, but the general workflow should be the same.</li>
</ul>
<p>This comprehensive guide should help you extract the NDVI time series for your yield points. Remember to double-check your CRS at every step!  If you encounter specific errors, please provide the error message and details about your data, and I'll do my best to assist you further.</p>
</details>
</div>
<p><strong>Screen share with Google AI Studio and ask it questions on where to find tools and features in the QGIS user interface as you work in a desktop GIS</strong> </p>
<p>Using <a href="https://aistudio.google.com" target="_blank">Google AI Studio</a> you can screen share QGIS with Gemini and verbally ask questions for help with completing tasks and navigating the user interface; for example, where to find processing tools and how to configure them for GIS operations.</p>
<iframe src="https://drive.google.com/file/d/1kaYEcQ229sXiDA0ph_Ov5Vs8cS4j7zkv/preview" width="640" height="480" allow="autoplay"></iframe>

<p><em>Screen share of QGIS with Google AI Studio to get help with merging polygons.</em></p>
<h2 id="ai-for-programming-and-data-analysis">AI for programming and data analysis<a class="headerlink" href="#ai-for-programming-and-data-analysis" title="Permanent link">&para;</a></h2>
<p><strong>Use LLMs for programming from writing boilerplate code, generating examples and helping solve coding problems</strong></p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a Python function to merge three tables using a common ID column?</p>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">def</span> <span class="nf">merge_tables</span><span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span> <span class="n">table3</span><span class="p">,</span> <span class="n">common_id</span><span class="p">):</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="sd">    Merges three pandas DataFrames using a common ID column.</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="sd">    Args:</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="sd">        table1: The first pandas DataFrame.</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="sd">        table2: The second pandas DataFrame.</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="sd">        table3: The third pandas DataFrame.</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="sd">        common_id: The name of the common ID column (string).</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="sd">    Returns:</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="sd">        A new pandas DataFrame containing the merged data, or None if an error occurs.</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="sd">        Prints informative messages if an issue is encountered.</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>        <span class="c1"># Check if the common ID column exists in all tables</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>        <span class="k">if</span> <span class="n">common_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table1</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">common_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table2</span><span class="o">.</span><span class="n">columns</span> <span class="ow">or</span> <span class="n">common_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table3</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: Common ID column &#39;</span><span class="si">{</span><span class="n">common_id</span><span class="si">}</span><span class="s2">&#39; not found in all tables.&quot;</span><span class="p">)</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>            <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>        <span class="c1"># Merge the tables</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>        <span class="n">merged_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">common_id</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>  <span class="c1"># Outer join to keep all rows</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>        <span class="n">merged_table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged_table</span><span class="p">,</span> <span class="n">table3</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">common_id</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">)</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>        <span class="k">return</span> <span class="n">merged_table</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred during merging: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="c1"># Example Usage:</span>
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="c1"># Create sample DataFrames (replace with your actual data)</span>
</span><span id="__span-2-37"><a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="n">data1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;Value1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">]}</span>
</span><span id="__span-2-38"><a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="n">table1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data1</span><span class="p">)</span>
</span><span id="__span-2-39"><a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a>
</span><span id="__span-2-40"><a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="n">data2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;Value2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]}</span>
</span><span id="__span-2-41"><a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a><span class="n">table2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>
</span><span id="__span-2-42"><a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a>
</span><span id="__span-2-43"><a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="n">data3</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ID&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s1">&#39;Value3&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;L&#39;</span><span class="p">]}</span>
</span><span id="__span-2-44"><a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="n">table3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data3</span><span class="p">)</span>
</span><span id="__span-2-45"><a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a>
</span><span id="__span-2-46"><a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a><span class="n">common_id_column</span> <span class="o">=</span> <span class="s1">&#39;ID&#39;</span>
</span><span id="__span-2-47"><a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a>
</span><span id="__span-2-48"><a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="n">merged_data</span> <span class="o">=</span> <span class="n">merge_tables</span><span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span> <span class="n">table3</span><span class="p">,</span> <span class="n">common_id_column</span><span class="p">)</span>
</span><span id="__span-2-49"><a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a>
</span><span id="__span-2-50"><a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a><span class="k">if</span> <span class="n">merged_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-2-51"><a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>  <span class="c1"># Print the merged DataFrame</span>
</span><span id="__span-2-52"><a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a>    <span class="c1"># You can now save it to a new file, perform further operations, etc.</span>
</span><span id="__span-2-53"><a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a>    <span class="c1"># For example, to save to a CSV:</span>
</span><span id="__span-2-54"><a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a>    <span class="c1"># merged_data.to_csv(&quot;merged_data.csv&quot;, index=False)</span>
</span></code></pre></div>
<p>Explanation and Improvements:</p>
<ul>
<li>Error Handling: The code includes a try...except block to catch potential errors during the merge process. This makes the function more robust. It also checks if the common_id column actually exists in all tables before attempting the merge.</li>
<li>Clearer Error Messages: The print() statements provide more informative messages if there's an issue, making debugging easier.</li>
<li>Outer Join: The how='outer' parameter in pd.merge() performs an outer join. This is crucial. An outer join ensures that all rows from all tables are included in the merged table. If a particular ID is missing in one of the tables, the corresponding columns for that table will have NaN (Not a Number) values. This prevents data loss.</li>
<li>Example Usage: The example code demonstrates how to use the function with sample DataFrames. Replace these sample DataFrames with your actual data. It also shows how to save the result to a CSV file.</li>
<li>Conciseness: The code is more concise and readable.</li>
<li>Flexibility: The function is more flexible, as it can handle cases where one or more of the DataFrames might not contain all the IDs present in the others.</li>
</ul>
<p>How to Use with Your Data:</p>
<p>Import pandas: </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span></code></pre></div>
<p>Read your tables: Use pd.read_csv(), pd.read_excel(), or other appropriate pandas functions to read your three tables into pandas DataFrames. For example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">table1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;table1.csv&quot;</span><span class="p">)</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">table2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;table2.csv&quot;</span><span class="p">)</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">table3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;table3.csv&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>Call the function:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">merged_data</span> <span class="o">=</span> <span class="n">merge_tables</span><span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span> <span class="n">table3</span><span class="p">,</span> <span class="s2">&quot;ID&quot;</span><span class="p">)</span>  <span class="c1"># Replace &quot;ID&quot; with your actual common ID column name</span>
</span></code></pre></div>
<p>Handle the result:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">if</span> <span class="n">merged_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    <span class="n">merged_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;merged_result.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Save to a CSV</span>
</span></code></pre></div>
<p>Remember to replace "table1.csv", "table2.csv", "table3.csv", and "ID" with the actual paths to your files and the name of your common ID column.`</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write Python code snippet to open a NetCDF file and print information about the files contents?</p>
<div class="admonition tip">
<p class="admonition-title">Use LLMs to help you work with different file formats</p>
<p>A wide range of file formats are used to store and transfer geospatial and agricultural data (e.g. see the list of raster file formats supported by <a href="https://gdal.org/en/stable/drivers/raster/index.html" target="_blank">GDAL</a>). It's not always obvious how data is stored in different file formats or how to read data from them. </p>
<p>LLMs can be a useful tool to give you quick examples of how to read data from a new format and provide an introduction to working with file formats that might be more accessible than their technical documentation. </p>
<p>Often, there is more than one way to read data from a file format. You could improve this prompt by asking the model to provide examples of different ways to open a NetCFD file and comment on their strengths and weaknesses. </p>
</div>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">import</span> <span class="nn">netCDF4</span>  <span class="c1"># Import the netCDF4 library</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="k">def</span> <span class="nf">print_netcdf_info</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Opens a NetCDF file and prints information about its contents.</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="sd">    Args:</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="sd">        filepath: The path to the NetCDF file (string).</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>        <span class="c1"># Open the NetCDF file in read mode (&#39;r&#39;)</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>        <span class="k">with</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_file</span><span class="p">:</span>  <span class="c1"># Use &#39;with&#39; for automatic closing</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NetCDF file: </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>            <span class="c1"># Print global attributes (metadata)</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Global Attributes:&quot;</span><span class="p">)</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>            <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">nc_file</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">():</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">nc_file</span><span class="o">.</span><span class="n">getncattr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>            <span class="c1"># Print dimensions</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dimensions:&quot;</span><span class="p">)</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>            <span class="k">for</span> <span class="n">dim_name</span><span class="p">,</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">nc_file</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">dim_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>            <span class="c1"># Print variables</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Variables:&quot;</span><span class="p">)</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>            <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">nc_file</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">var_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Dimensions: </span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">dimensions</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Shape: </span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Data type: </span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Attributes:&quot;</span><span class="p">)</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>                <span class="k">for</span> <span class="n">attr_name</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">ncattrs</span><span class="p">():</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;      </span><span class="si">{</span><span class="n">attr_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">getncattr</span><span class="p">(</span><span class="n">attr_name</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a>                <span class="c1"># Print a few values (optional - for small variables only!)</span>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a>                <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>  <span class="c1"># Avoid printing huge arrays</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a>                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    Values: </span><span class="si">{</span><span class="n">var</span><span class="p">[:]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># [:] gets all data</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>    <span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: NetCDF file not found at </span><span class="si">{</span><span class="n">filepath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a><span class="c1"># Example usage:</span>
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;your_netcdf_file.nc&quot;</span>  <span class="c1"># Replace with the actual path to your NetCDF file</span>
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a><span class="n">print_netcdf_info</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a><span class="c1"># Example of reading data from a specific variable:</span>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a><span class="k">def</span> <span class="nf">read_netcdf_variable</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">variable_name</span><span class="p">):</span>
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a>        <span class="k">with</span> <span class="n">netCDF4</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">nc_file</span><span class="p">:</span>
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a>            <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="n">nc_file</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a>                <span class="n">variable_data</span> <span class="o">=</span> <span class="n">nc_file</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">][:]</span>  <span class="c1"># Read all data</span>
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>                <span class="k">return</span> <span class="n">variable_data</span>
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Variable &#39;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">&#39; not found in the NetCDF file.&quot;</span><span class="p">)</span>
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>                <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a>
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a><span class="c1"># Example usage of reading a variable</span>
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a><span class="n">temperature_data</span> <span class="o">=</span> <span class="n">read_netcdf_variable</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s2">&quot;temperature&quot;</span><span class="p">)</span> <span class="c1"># Replace &quot;temperature&quot; with your variable name</span>
</span><span id="__span-7-66"><a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a><span class="k">if</span> <span class="n">temperature_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-7-67"><a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">temperature_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="c1"># Print the shape of the data</span>
</span><span id="__span-7-68"><a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">temperature_data</span><span class="p">)</span> <span class="c1"># Print the data (optional)</span>
</span></code></pre></div>
<p>Key Improvements and Explanations:</p>
<ul>
<li>netCDF4 Library: The code uses the netCDF4 library, which is the recommended way to work with NetCDF files in Python. You'll likely need to install it: pip install netCDF4</li>
<li>Error Handling: The <code>try...except</code> block handles potential errors, such as the file not being found or other issues during file processing. This makes the code more robust.</li>
<li><code>with</code> Statement: The <code>with netCDF4.Dataset(...) as nc_file:</code> construct ensures that the NetCDF file is automatically closed, even if errors occur. This is best practice.</li>
<li>Clear Output: The code prints information about global attributes, dimensions, and variables in a well-formatted way.
Variable Information: For each variable, it prints the dimensions, shape, data type, and attributes.</li>
<li>Optional Data Printing: It includes an option to print a few values from the variables. However, this is only done if the variable is relatively small (less than 100 elements) to avoid printing huge arrays to the console.</li>
<li>Example of reading a variable: The <code>read_netcdf_variable</code> function demonstrates how to read the data from a specific variable in a NetCDF file. This is how you would actually access the data for analysis.</li>
<li>Comments: The code is well-commented to explain what each part does.</li>
</ul>
<p>How to Use:</p>
<ul>
<li>Install netCDF4: <code>pip install netCDF4</code></li>
<li>Replace <code>your_netcdf_file.nc</code>: Change <code>"your_netcdf_file.nc"</code> to the actual path of your NetCDF file.</li>
<li>Run the script: Execute the Python script. It will print information about the NetCDF file's contents.</li>
<li>Access Variable Data: Use the read_netcdf_variable function to get the data for the variables you need. Remember to replace <code>"temperature"</code> with the actual name of the variable you want. You can then work with the data (e.g., plot it, perform calculations, etc.).</li>
</ul>
</details>
</div>
<p><strong>Use LLMs to improve or optimise code</strong></p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>From the perspective of a senior developer reviewing code, can you suggest how to improve the following Python function?</p>
<p>The two variables <code>precip_jan_2024</code> and <code>precip_jan_2025</code> are 3D arrays of shape (time, X, Y) storing precipitation daily precipitation values. The code is trying to create monthly sums of precipitation for each pixel and then compute the change in precipitation between 2024 and 2025.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">precip_jan_2024_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">precip_jan_2024</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">precip_jan_2024</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precip_jan_2024</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precip_jan_2024</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>        <span class="n">precip_jan_2024_sum</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">precip_jan_2024</span><span class="p">[:,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="n">precip_jan_2025_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">precip_jan_2025</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">precip_jan_2025</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precip_jan_2025</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precip_jan_2025</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="n">precip_jan_2025_sum</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">precip_jan_2025</span><span class="p">[:,</span> <span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="n">diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">precip_jan_2025_sum</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">precip_jan_2025_sum</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precip_jan_2024_sum</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">precip_jan_2024_sum</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>        <span class="n">diff</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="n">precip_jan_2025_sum</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="n">precip_jan_2024_sum</span><span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>
</span></code></pre></div>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="k">def</span> <span class="nf">calculate_precipitation_change</span><span class="p">(</span><span class="n">precip_jan_2024</span><span class="p">,</span> <span class="n">precip_jan_2025</span><span class="p">):</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the change in monthly precipitation between two years.</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="sd">    Args:</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="sd">        precip_jan_2024: 3D numpy array (time, X, Y) of daily precipitation </span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="sd">                        values for January 2024.</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="sd">        precip_jan_2025: 3D numpy array (time, X, Y) of daily precipitation </span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="sd">                        values for January 2025.  Must have the same X and Y</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="sd">                        dimensions as precip_jan_2024.</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a><span class="sd">    Returns:</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="sd">        A 2D numpy array representing the difference in total monthly </span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="sd">        precipitation between January 2025 and January 2024 for each </span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="sd">        grid point (X, Y).  Returns None if the input arrays have incompatible</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="sd">        shapes.</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>    <span class="k">if</span> <span class="n">precip_jan_2024</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">precip_jan_2025</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>  <span class="c1"># Check X, Y dimensions</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Precipitation arrays have incompatible X and Y dimensions.&quot;</span><span class="p">)</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>    <span class="n">precip_jan_2024_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">precip_jan_2024</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Sum along the time axis</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>    <span class="n">precip_jan_2025_sum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">precip_jan_2025</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a>    <span class="n">diff</span> <span class="o">=</span> <span class="n">precip_jan_2025_sum</span> <span class="o">-</span> <span class="n">precip_jan_2024_sum</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a>    <span class="k">return</span> <span class="n">diff</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="c1"># Example (replace with your actual data):</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="n">precip_2024</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># 31 days, 10x10 grid</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="n">precip_2025</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="n">precipitation_diff</span> <span class="o">=</span> <span class="n">calculate_precipitation_change</span><span class="p">(</span><span class="n">precip_2024</span><span class="p">,</span> <span class="n">precip_2025</span><span class="p">)</span>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="k">if</span> <span class="n">precipitation_diff</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a>    <span class="nb">print</span><span class="p">(</span><span class="n">precipitation_diff</span><span class="p">)</span>
</span></code></pre></div>
<p>Key Improvements and Explanations:</p>
<ul>
<li>Vectorization: The original code used nested loops to iterate over the X and Y dimensions. This is very inefficient in Python, especially with NumPy.  The improved code uses NumPy's vectorized operations (np.sum with the axis parameter) to perform the summations and difference calculation.  Vectorization is orders of magnitude faster.</li>
<li>Function: Encapsulating the code within a function (calculate_precipitation_change) makes it reusable, more organized, and easier to test.</li>
<li>Input Validation: The function now checks if the X and Y dimensions of the input arrays are compatible. This is a crucial step for robust code.  It returns None and prints an informative message if the shapes don't match.</li>
<li>Clearer Variable Names:  Slightly more descriptive variable names (e.g., precip_jan_2024_sum instead of just sum2024) improve readability.</li>
<li>Docstring: The function includes a docstring explaining its purpose, arguments, and return value. This is essential for maintainability and collaboration.</li>
<li>Removed Redundant Initialization: The original code initialized precip_jan_2024_sum, precip_jan_2025_sum and diff with zeros. This is not needed when using np.sum with the axis argument.</li>
<li>Direct Calculation: The difference is now calculated directly using NumPy's broadcasting.  This is another example of vectorization and is much more efficient than looping.</li>
</ul>
<p>Why Vectorization is Crucial:</p>
<p>NumPy's vectorized operations are implemented in C and are highly optimized.  When you use loops in Python to perform numerical calculations on arrays, you're essentially iterating through the array elements in Python, which is slow.  Vectorization allows NumPy to perform the operations on the entire array (or a specified axis) at once, using optimized C code under the hood. The performance difference can be enormous, especially for large datasets.  Always try to vectorize your NumPy code whenever possible.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>From the perspective of a senior developer reviewing code, can you suggest how to optimise the following Python script? </p>
<p>Can you explain how these optimisations work and are suitable for this program?</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">import</span> <span class="nn">pystac</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="kn">import</span> <span class="nn">planetary_computer</span> <span class="k">as</span> <span class="nn">pc</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="kn">import</span> <span class="nn">rioxarray</span>  <span class="c1"># For easier raster handling</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1"># get Sentinel-2 images from Planetary Computer</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="k">def</span> <span class="nf">get_sentinel2_images_unoptimized</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">cloud_cover_max</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves Sentinel-2 images from Planetary Computer.&quot;&quot;&quot;</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>    <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="o">.</span><span class="n">from_file_stac_catalog</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">CATALOG_URL</span><span class="p">)</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="n">items</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>        <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>        <span class="n">datetime</span><span class="o">=</span><span class="p">[</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">],</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>        <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">],</span>  <span class="c1"># Or appropriate collection</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a>    <span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a>    <span class="n">image_data</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to hold image data (inefficient)</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a>        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">cloud_cover_max</span><span class="p">:</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a>            <span class="n">asset</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span> <span class="c1"># Get the image asset</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a>            <span class="n">href</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">href</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a>                <span class="c1"># Open the raster data</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a>                <span class="n">raster</span> <span class="o">=</span> <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">href</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> <span class="c1"># Squeeze to remove extra dimensions</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a>                <span class="n">image_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">raster</span><span class="p">)</span> <span class="c1"># Append to a list - inefficient!</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error processing item </span><span class="si">{</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">image_data</span><span class="p">:</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a>    <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">image_data</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span> <span class="c1"># Concatenate the list of xarray DataArrays</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a>    <span class="k">return</span> <span class="n">combined_data</span>
</span></code></pre></div>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<p>This code snippet retrieves Sentinel-2 images from the Planetary Computer using the pystac library for searching the STAC catalog and rioxarray for loading the images as xarray DataArrays. Here's an optimized version with explanations:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">import</span> <span class="nn">pystac</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kn">import</span> <span class="nn">planetary_computer</span> <span class="k">as</span> <span class="nn">pc</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kn">import</span> <span class="nn">rioxarray</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="k">def</span> <span class="nf">get_sentinel2_images_optimized</span><span class="p">(</span><span class="n">bbox</span><span class="p">,</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">cloud_cover_max</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves Sentinel-2 images from Planetary Computer (optimized).&quot;&quot;&quot;</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>    <span class="n">catalog</span> <span class="o">=</span> <span class="n">pystac</span><span class="o">.</span><span class="n">Catalog</span><span class="o">.</span><span class="n">from_file_stac_catalog</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">CATALOG_URL</span><span class="p">)</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>    <span class="n">search</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">search</span><span class="p">(</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>        <span class="n">bbox</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>        <span class="n">datetime</span><span class="o">=</span><span class="p">[</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">],</span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>        <span class="n">collections</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;sentinel-2-l2a&quot;</span><span class="p">],</span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>        <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;eo:cloud_cover&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lt&quot;</span><span class="p">:</span> <span class="n">cloud_cover_max</span><span class="p">}}</span>  <span class="c1"># Filter by cloud cover</span>
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>    <span class="p">)</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a>    <span class="n">items</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">get_items</span><span class="p">()</span>  <span class="c1"># Retrieve the items</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>    <span class="c1"># Use a generator expression for efficient filtering and data loading</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>    <span class="n">image_data_generator</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a>        <span class="n">rioxarray</span><span class="o">.</span><span class="n">open_rasterio</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">assets</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">href</span><span class="p">,</span> <span class="n">masked</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a>    <span class="p">)</span>
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>        <span class="c1"># Concatenate directly from the generator (memory-efficient)</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a>        <span class="n">combined_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">image_data_generator</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>        <span class="k">return</span> <span class="n">combined_data</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Handle the case where no images are found</span>
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No Sentinel-2 images found matching the criteria.&quot;</span><span class="p">)</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># Catch other potential errors during processing</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>        <span class="k">return</span> <span class="kc">None</span>
</span></code></pre></div>
<p>Key Improvements and Explanations:</p>
<ul>
<li>Cloud Cover Filtering in STAC Query: The optimized version filters the images by cloud cover directly in the STAC query using the query parameter. This reduces the number of items retrieved and processed, improving efficiency.</li>
<li>Generator Expression: Instead of appending each image to a list and then concatenating, the optimized version uses a generator expression within the xr.concat function. This avoids loading all the images into memory at once, which is crucial when dealing with large datasets.</li>
<li>Direct Concatenation: Concatenating directly from the generator is more memory-efficient than creating an intermediate list of xarray DataArrays.</li>
<li>Error Handling: The optimized version includes a try...except block to handle potential errors during file opening or concatenation. It also specifically handles the ValueError that can occur if xr.concat is called with an empty iterable (i.e., no images are found).</li>
</ul>
<p>Why these changes are important:</p>
<ul>
<li>Memory Efficiency: The generator expression and direct concatenation significantly reduce memory usage, especially when dealing with many or large images.</li>
<li>Performance: The optimized version is likely to be faster due to reduced data retrieval and more efficient concatenation.</li>
<li>Robustness: Error handling makes the code more reliable and prevents crashes due to unexpected issues.</li>
<li>Best Practices: Using generator expressions, direct concatenation, and proper error handling are considered best practices in Python, making your code more efficient, reliable, and maintainable.</li>
</ul>
<p>This optimized version demonstrates how to efficiently retrieve and process Sentinel-2 images from the Planetary Computer while adhering to best practices for memory management and error handling.</p>
</details>
</div>
<p><strong>Use LLMs to tidy up, style and document code</strong></p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you add documentation to the following Python code? It is a function that computes the maximum NDVI value in a time-series with the data stored in a 3D array. </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="k">def</span> <span class="nf">estimate_max_ndvi_3d</span><span class="p">(</span><span class="n">ndvi_array</span><span class="p">):</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>    <span class="n">max_ndvi_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">ndvi_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    <span class="k">return</span> <span class="n">max_ndvi_values</span>
</span></code></pre></div>
<details class="note">
<summary>Response (ChatGPT)</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="k">def</span> <span class="nf">estimate_max_ndvi_3d</span><span class="p">(</span><span class="n">ndvi_array</span><span class="p">):</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="sd">    Computes the maximum NDVI (Normalized Difference Vegetation Index) value over time.</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="sd">    This function takes a 3D NumPy array representing NDVI values recorded over time </span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="sd">    and computes the maximum NDVI value at each spatial location while ignoring NaN values.</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="sd">    Parameters</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="sd">    ----------</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="sd">    ndvi_array : numpy.ndarray</span>
</span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="sd">        A 3D array of NDVI values with shape (time, height, width), where:</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="sd">        - `time` represents different time points in the series.</span>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="sd">        - `height` and `width` correspond to the spatial dimensions.</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="sd">    Returns</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="sd">    -------</span>
</span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="sd">    numpy.ndarray</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a><span class="sd">        A 2D array of maximum NDVI values with shape (height, width), containing </span>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="sd">        the highest NDVI value observed at each spatial location over time.</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="sd">    Notes</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="sd">    -----</span>
</span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="sd">    - The function uses `numpy.nanmax` to ignore NaN values when computing the maximum.</span>
</span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="sd">    - If all values for a given spatial location are NaN, the result will be NaN at that location.</span>
</span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>
</span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="sd">    Example</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="sd">    -------</span>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="sd">    &gt;&gt;&gt; import numpy as np</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="sd">    &gt;&gt;&gt; ndvi_data = np.array([</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="sd">    ...     [[0.2, 0.4], [0.1, np.nan]],</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a><span class="sd">    ...     [[0.5, 0.3], [0.6, 0.7]],</span>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="sd">    ...     [[0.3, 0.6], [np.nan, 0.8]]</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="sd">    ... ])</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="sd">    &gt;&gt;&gt; estimate_max_ndvi_3d(ndvi_data)</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="sd">    array([[0.5, 0.6],</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="sd">        [0.6, 0.8]])</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a>    <span class="n">max_ndvi_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">ndvi_array</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Compute max along time axis, ignoring NaNs</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a>    <span class="k">return</span> <span class="n">max_ndvi_values</span>
</span></code></pre></div>
<p>Improvements</p>
<ul>
<li>Added a detailed docstring that follows the NumPy documentation style.</li>
<li>Explained input and output formats for better usability.</li>
<li>Included an example to demonstrate how the function works.</li>
</ul>
<p>This makes the function easier to understand, maintain, and use in larger projects. </p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>From the perspective of a senior developer reviewing code, can you suggest how to improve the clarity of the following Python code? It is a Python function that generates management zones from a multispectral UAV image and a soil map.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="k">def</span> <span class="nf">generate_management_zones</span><span class="p">(</span><span class="n">uav_image</span><span class="p">,</span> <span class="n">soil_map</span><span class="p">,</span> <span class="n">num_zones</span><span class="p">):</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>    <span class="n">uav_reshaped</span> <span class="o">=</span> <span class="n">uav_image</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">uav_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>    <span class="n">soil_reshaped</span> <span class="o">=</span> <span class="n">soil_map</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>    <span class="n">combined_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">uav_reshaped</span><span class="p">,</span> <span class="n">soil_reshaped</span><span class="p">))</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_zones</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">combined_data</span><span class="p">)</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>    <span class="n">zones</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">uav_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>    <span class="k">return</span> <span class="n">zones</span>
</span></code></pre></div>
<details class="note">
<summary>Response (ChatGPT)</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kn">from</span> <span class="nn">sklearn.cluster</span> <span class="kn">import</span> <span class="n">KMeans</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="k">def</span> <span class="nf">generate_management_zones</span><span class="p">(</span><span class="n">multispectral_image</span><span class="p">,</span> <span class="n">soil_data</span><span class="p">,</span> <span class="n">num_clusters</span><span class="p">):</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="sd">    Generate management zones for a field using k-means clustering on multispectral UAV imagery and soil data.</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="sd">    Parameters:</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="sd">    - multispectral_image: numpy.ndarray</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="sd">        A 3D array representing the multispectral UAV image with dimensions (height, width, num_bands).</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="sd">    - soil_data: numpy.ndarray</span>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="sd">        A 2D array representing the soil map with dimensions (height, width).</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="sd">    - num_clusters: int</span>
</span><span id="__span-15-14"><a id="__codelineno-15-14" name="__codelineno-15-14" href="#__codelineno-15-14"></a><span class="sd">        The desired number of management zones (clusters).</span>
</span><span id="__span-15-15"><a id="__codelineno-15-15" name="__codelineno-15-15" href="#__codelineno-15-15"></a>
</span><span id="__span-15-16"><a id="__codelineno-15-16" name="__codelineno-15-16" href="#__codelineno-15-16"></a><span class="sd">    Returns:</span>
</span><span id="__span-15-17"><a id="__codelineno-15-17" name="__codelineno-15-17" href="#__codelineno-15-17"></a><span class="sd">    - management_zones: numpy.ndarray</span>
</span><span id="__span-15-18"><a id="__codelineno-15-18" name="__codelineno-15-18" href="#__codelineno-15-18"></a><span class="sd">        A 2D array with the same spatial dimensions as the input data, where each element indicates the assigned management zone.</span>
</span><span id="__span-15-19"><a id="__codelineno-15-19" name="__codelineno-15-19" href="#__codelineno-15-19"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-15-20"><a id="__codelineno-15-20" name="__codelineno-15-20" href="#__codelineno-15-20"></a>    <span class="c1"># Reshape the multispectral image to a 2D array where each row is a pixel and each column is a spectral band</span>
</span><span id="__span-15-21"><a id="__codelineno-15-21" name="__codelineno-15-21" href="#__codelineno-15-21"></a>    <span class="n">pixels</span> <span class="o">=</span> <span class="n">multispectral_image</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">multispectral_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span><span id="__span-15-22"><a id="__codelineno-15-22" name="__codelineno-15-22" href="#__codelineno-15-22"></a>
</span><span id="__span-15-23"><a id="__codelineno-15-23" name="__codelineno-15-23" href="#__codelineno-15-23"></a>    <span class="c1"># Flatten the soil data to create a 1D array of soil values</span>
</span><span id="__span-15-24"><a id="__codelineno-15-24" name="__codelineno-15-24" href="#__codelineno-15-24"></a>    <span class="n">soil_values</span> <span class="o">=</span> <span class="n">soil_data</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-15-25"><a id="__codelineno-15-25" name="__codelineno-15-25" href="#__codelineno-15-25"></a>
</span><span id="__span-15-26"><a id="__codelineno-15-26" name="__codelineno-15-26" href="#__codelineno-15-26"></a>    <span class="c1"># Combine the spectral and soil data into a single feature array</span>
</span><span id="__span-15-27"><a id="__codelineno-15-27" name="__codelineno-15-27" href="#__codelineno-15-27"></a>    <span class="n">features</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">pixels</span><span class="p">,</span> <span class="n">soil_values</span><span class="p">))</span>
</span><span id="__span-15-28"><a id="__codelineno-15-28" name="__codelineno-15-28" href="#__codelineno-15-28"></a>
</span><span id="__span-15-29"><a id="__codelineno-15-29" name="__codelineno-15-29" href="#__codelineno-15-29"></a>    <span class="c1"># Initialize the k-means clustering algorithm with the specified number of clusters</span>
</span><span id="__span-15-30"><a id="__codelineno-15-30" name="__codelineno-15-30" href="#__codelineno-15-30"></a>    <span class="n">kmeans</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">n_clusters</span><span class="o">=</span><span class="n">num_clusters</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="__span-15-31"><a id="__codelineno-15-31" name="__codelineno-15-31" href="#__codelineno-15-31"></a>
</span><span id="__span-15-32"><a id="__codelineno-15-32" name="__codelineno-15-32" href="#__codelineno-15-32"></a>    <span class="c1"># Fit the k-means algorithm to the combined feature data</span>
</span><span id="__span-15-33"><a id="__codelineno-15-33" name="__codelineno-15-33" href="#__codelineno-15-33"></a>    <span class="n">kmeans</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</span><span id="__span-15-34"><a id="__codelineno-15-34" name="__codelineno-15-34" href="#__codelineno-15-34"></a>
</span><span id="__span-15-35"><a id="__codelineno-15-35" name="__codelineno-15-35" href="#__codelineno-15-35"></a>    <span class="c1"># Retrieve the cluster labels for each pixel and reshape them to match the original image dimensions</span>
</span><span id="__span-15-36"><a id="__codelineno-15-36" name="__codelineno-15-36" href="#__codelineno-15-36"></a>    <span class="n">management_zones</span> <span class="o">=</span> <span class="n">kmeans</span><span class="o">.</span><span class="n">labels_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">multispectral_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
</span><span id="__span-15-37"><a id="__codelineno-15-37" name="__codelineno-15-37" href="#__codelineno-15-37"></a>
</span><span id="__span-15-38"><a id="__codelineno-15-38" name="__codelineno-15-38" href="#__codelineno-15-38"></a>    <span class="k">return</span> <span class="n">management_zones</span>
</span></code></pre></div>
<p>Explanation:</p>
<p>Reshaping the Multispectral Image:</p>
<ul>
<li>The multispectral UAV image is a 3D array with dimensions corresponding to height, width, and the number of spectral bands.</li>
<li>We reshape this array into a 2D array (<code>pixels</code>) where each row represents a pixel, and each column corresponds to a spectral band. This transformation is necessary for clustering, as k-means operates on 2D data matrices.</li>
</ul>
<p>Flattening the Soil Data:</p>
<ul>
<li>The soil map is a 2D array with spatial dimensions matching the multispectral image.</li>
<li>We flatten this array into a 1D array (<code>soil_values</code>) to align each soil measurement with the corresponding pixel in the multispectral image.</li>
</ul>
<p>Combining Features:</p>
<ul>
<li>We horizontally stack (<code>np.hstack</code>) the spectral data (<code>pixels</code>) and the soil data (<code>soil_values</code>) to form a single feature matrix (<code>features</code>). Each row in this matrix represents a pixel with its associated spectral and soil attributes.</li>
</ul>
<p>Applying K-Means Clustering:</p>
<ul>
<li>We initialize the k-means algorithm with the desired number of clusters (<code>num_clusters</code>) and a fixed random state for reproducibility.</li>
<li>The <code>fit</code> method is used to perform clustering on the combined feature matrix.</li>
</ul>
<p>Reshaping Cluster Labels:</p>
<ul>
<li>The <code>labels_</code> attribute of the fitted k-means model contains the cluster assignments for each pixel.</li>
<li>We reshape these labels back into a 2D array (<code>management_zones</code>) that matches the spatial dimensions of the original multispectral image, where each element indicates the assigned management zone.</li>
</ul>
<p>This function effectively integrates multispectral imagery and soil data to delineate distinct management zones within a field, facilitating targeted agricultural practices.</p>
</details>
</div>
<p><strong>Use LLMs to help you retrieve data from, or upload data to, web APIs and online data providers</strong></p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I am a geospatial consultant working for an agricultural technology company that specialises in precision agriculture. I need to upload drone imagery of a farmer's paddock to John Deere's Operations Centre Map Layers. The drone imagery is a GeoTIFF file. </p>
<p>Can you write Python code that uploads this image to the correct Map Layers endpoint? </p>
<p>Can you provide a step-by-step explanation of the process and also review the code for security issues?</p>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># Replace with your actual values</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="n">client_id</span> <span class="o">=</span> <span class="s2">&quot;YOUR_CLIENT_ID&quot;</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="n">client_secret</span> <span class="o">=</span> <span class="s2">&quot;YOUR_CLIENT_SECRET&quot;</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">refresh_token</span> <span class="o">=</span> <span class="s2">&quot;YOUR_REFRESH_TOKEN&quot;</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="n">api_url</span> <span class="o">=</span> <span class="s2">&quot;https://sandboxapi.deere.com/platform&quot;</span>  <span class="c1"># Use sandbox for testing</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">tiff_filepath</span> <span class="o">=</span> <span class="s2">&quot;path/to/your/drone_imagery.tiff&quot;</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="k">def</span> <span class="nf">get_access_token</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">):</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves an access token using the provided refresh token.&quot;&quot;&quot;</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">api_url</span><span class="si">}</span><span class="s2">/oauth2/token&quot;</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>        <span class="s2">&quot;grant_type&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_token&quot;</span><span class="p">,</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>        <span class="s2">&quot;client_id&quot;</span><span class="p">:</span> <span class="n">client_id</span><span class="p">,</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>        <span class="s2">&quot;client_secret&quot;</span><span class="p">:</span> <span class="n">client_secret</span><span class="p">,</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>        <span class="s2">&quot;refresh_token&quot;</span><span class="p">:</span> <span class="n">refresh_token</span><span class="p">,</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a>    <span class="p">}</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a>    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raise an exception for bad status codes</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s2">&quot;access_token&quot;</span><span class="p">]</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a><span class="k">def</span> <span class="nf">upload_to_map_layers</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">tiff_filepath</span><span class="p">):</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Uploads a GeoTIFF file to the Map Layers endpoint.&quot;&quot;&quot;</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">api_url</span><span class="si">}</span><span class="s2">/mapLayers&quot;</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a>    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>        <span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>        <span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/vnd.deere.axiom.v3+json&quot;</span><span class="p">,</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>    <span class="p">}</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a>    <span class="c1"># The &#39;files&#39; parameter needs to be a list of tuples</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32" href="#__codelineno-16-32"></a>    <span class="n">files</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;drone_imagery.tiff&quot;</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">tiff_filepath</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">),</span> <span class="s2">&quot;image/tiff&quot;</span><span class="p">))]</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33" href="#__codelineno-16-33"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34" href="#__codelineno-16-34"></a>    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35" href="#__codelineno-16-35"></a>    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36" href="#__codelineno-16-36"></a>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37" href="#__codelineno-16-37"></a><span class="c1"># --- Main execution ---</span>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38" href="#__codelineno-16-38"></a><span class="n">access_token</span> <span class="o">=</span> <span class="n">get_access_token</span><span class="p">(</span><span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">)</span>
</span><span id="__span-16-39"><a id="__codelineno-16-39" name="__codelineno-16-39" href="#__codelineno-16-39"></a><span class="n">response_data</span> <span class="o">=</span> <span class="n">upload_to_map_layers</span><span class="p">(</span><span class="n">access_token</span><span class="p">,</span> <span class="n">tiff_filepath</span><span class="p">)</span>
</span><span id="__span-16-40"><a id="__codelineno-16-40" name="__codelineno-16-40" href="#__codelineno-16-40"></a>
</span><span id="__span-16-41"><a id="__codelineno-16-41" name="__codelineno-16-41" href="#__codelineno-16-41"></a><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>  <span class="c1"># Print the response</span>
</span></code></pre></div>
<p>Step-by-step explanation</p>
<p>Import necessary libraries:</p>
<p><code>requests</code>: for making HTTP requests to the API.
<code>json</code>: for handling JSON data.</p>
<p>Set up credentials and API endpoint:</p>
<p>Replace the placeholder values for <code>client_id</code>, <code>client_secret</code>, <code>refresh_token</code>, and <code>tiff_filepath</code> with your actual values.</p>
<p>Use the sandbox API URL (https://sandboxapi.deere.com/platform) for testing. Once your code is working, switch to the production URL.</p>
<p><code>get_access_token</code> function:</p>
<p>Sends a POST request to the OAuth2 token endpoint to obtain an access token using the refresh token.
Includes error handling to raise an exception if the request fails.</p>
<p><code>upload_to_map_layers</code> function:</p>
<ul>
<li>Sends a POST request to the Map Layers endpoint to upload the GeoTIFF file.</li>
<li>Sets the necessary headers, including the Authorization header with the access token.</li>
<li>Uses the files parameter to include the GeoTIFF file in the request.</li>
<li>Includes error handling to raise an exception if the request fails.</li>
</ul>
<p>Main execution:</p>
<ul>
<li>Calls <code>get_access_token</code> to obtain the access token.</li>
<li>Calls <code>upload_to_map_layers</code> to upload the GeoTIFF file.</li>
<li>Prints the JSON response from the API.</li>
</ul>
<p>Security review</p>
<p>API credentials:</p>
<ul>
<li>Never hardcode API credentials directly in your code. This is a major security risk. Instead, use environment variables, configuration files, or a secrets management service to store and retrieve your credentials.</li>
<li>Error handling: The code includes basic error handling to raise exceptions for failed requests.
Consider adding more specific error handling based on the possible HTTP status codes and error responses from the API.</li>
<li>Data validation: The code currently doesn't validate the input data (e.g., tiff_filepath).
Add validation to ensure the provided file path is valid and the file exists.</li>
<li>HTTPS: The code uses HTTPS to communicate with the API, which is essential for secure communication.</li>
<li>Sandboxing: Using the sandbox API for testing is a good security practice, as it prevents accidental modifications to production data.</li>
</ul>
<p>Additional considerations:</p>
<ul>
<li>Rate limiting: Be aware of the API's rate limits to avoid exceeding them and getting your requests throttled.</li>
<li>Documentation: Refer to the John Deere Operations Center API documentation for details on the Map Layers endpoint and other available functionalities.</li>
<li>Dependencies: Ensure you have the required libraries installed (requests). You can install them using <code>pip install requests</code>.</li>
</ul>
<p>Remember to replace the placeholder values with your actual credentials and file path before running the code. Always test your code in the sandbox environment before deploying it to production.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I need to download hourly evaporation data from NASA POWER's API. Can you write a function that will take in date range and location, request the data from NASA POWER's API, and process the response into a pandas DataFrame?</p>
<div class="admonition tip">
<p class="admonition-title">Practice iterative prompting</p>
<p>The initial response provided by ChatGPT is close to a working solution, but has some errors (e.g. the parameter is <code>EVLAND</code> not <code>EVAP</code>). This illustrates where LLMs can make mistakes and so it is important to verify their output (e.g. run the code). There are also some issues with formatting the date to create the pandas DataFrame. Here, you could do your own research of the NASA POWER API docs to identify the correct parameter and iteratively prompt the LLM to fix the date formatting issue. </p>
</div>
<details class="note">
<summary>Response (ChatGPT)</summary>
<p>To download hourly evaporation data from NASA's Prediction Of Worldwide Energy Resources (POWER) API, you can create a Python function that accepts a date range and location, requests the data, and processes the response into a pandas DataFrame. Here's how you can achieve this:</p>
<p>Step 1: Install Required Libraries</p>
<p>Ensure you have the necessary libraries installed:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>pip<span class="w"> </span>install<span class="w"> </span>requests<span class="w"> </span>pandas
</span></code></pre></div>
<p>Step 2: Define the Function</p>
<p>Below is the Python function to fetch and process the data:  </p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">def</span> <span class="nf">fetch_hourly_evaporation_data</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">):</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="sd">    Fetch hourly evaporation data from NASA POWER API for a given date range and location.</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="sd">    Parameters:</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="sd">    - start_date (str): Start date in &#39;YYYYMMDD&#39; format.</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="sd">    - end_date (str): End date in &#39;YYYYMMDD&#39; format.</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="sd">    - latitude (float): Latitude of the location.</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="sd">    - longitude (float): Longitude of the location.</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="sd">    Returns:</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="sd">    - pd.DataFrame: DataFrame containing the hourly evaporation data.</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>    <span class="c1"># Define the base URL for the NASA POWER API</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>    <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://power.larc.nasa.gov/api/temporal/hourly/point&quot;</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>    <span class="c1"># Define the parameters for the API request</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>        <span class="s2">&quot;start&quot;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>        <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">end_date</span><span class="p">,</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>        <span class="s2">&quot;latitude&quot;</span><span class="p">:</span> <span class="n">latitude</span><span class="p">,</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>        <span class="s2">&quot;longitude&quot;</span><span class="p">:</span> <span class="n">longitude</span><span class="p">,</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="s2">&quot;EVAP&quot;</span><span class="p">,</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>        <span class="s2">&quot;community&quot;</span><span class="p">:</span> <span class="s2">&quot;AG&quot;</span><span class="p">,</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;JSON&quot;</span><span class="p">,</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>        <span class="s2">&quot;time-standard&quot;</span><span class="p">:</span> <span class="s2">&quot;LST&quot;</span>  <span class="c1"># Local Solar Time</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>    <span class="p">}</span>
</span><span id="__span-18-31"><a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>
</span><span id="__span-18-32"><a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>    <span class="c1"># Make the API request</span>
</span><span id="__span-18-33"><a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span><span id="__span-18-34"><a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a>    <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raise an error for bad status codes</span>
</span><span id="__span-18-35"><a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a>
</span><span id="__span-18-36"><a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a>    <span class="c1"># Parse the JSON response</span>
</span><span id="__span-18-37"><a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-18-38"><a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a>
</span><span id="__span-18-39"><a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a>    <span class="c1"># Extract the hourly evaporation data</span>
</span><span id="__span-18-40"><a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a>    <span class="n">records</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;parameter&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;EVAP&#39;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="__span-18-41"><a id="__codelineno-18-41" name="__codelineno-18-41" href="#__codelineno-18-41"></a>
</span><span id="__span-18-42"><a id="__codelineno-18-42" name="__codelineno-18-42" href="#__codelineno-18-42"></a>    <span class="c1"># Convert the records into a DataFrame</span>
</span><span id="__span-18-43"><a id="__codelineno-18-43" name="__codelineno-18-43" href="#__codelineno-18-43"></a>    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Evaporation&#39;</span><span class="p">])</span>
</span><span id="__span-18-44"><a id="__codelineno-18-44" name="__codelineno-18-44" href="#__codelineno-18-44"></a>    <span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</span><span id="__span-18-45"><a id="__codelineno-18-45" name="__codelineno-18-45" href="#__codelineno-18-45"></a>    <span class="n">df</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-18-46"><a id="__codelineno-18-46" name="__codelineno-18-46" href="#__codelineno-18-46"></a>
</span><span id="__span-18-47"><a id="__codelineno-18-47" name="__codelineno-18-47" href="#__codelineno-18-47"></a>    <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div>
<p>Step 3: Usage Example</p>
<p>Here's how you can use the function:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Define your parameters</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">start_date</span> <span class="o">=</span> <span class="s2">&quot;20250101&quot;</span>  <span class="c1"># YYYYMMDD</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">end_date</span> <span class="o">=</span> <span class="s2">&quot;20250107&quot;</span>    <span class="c1"># YYYYMMDD</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">latitude</span> <span class="o">=</span> <span class="o">-</span><span class="mf">31.9505</span>      <span class="c1"># Example: Perth, Australia</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="n">longitude</span> <span class="o">=</span> <span class="mf">115.8605</span>     <span class="c1"># Example: Perth, Australia</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c1"># Fetch the data</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="n">evaporation_data</span> <span class="o">=</span> <span class="n">fetch_hourly_evaporation_data</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="c1"># Display the DataFrame</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="nb">print</span><span class="p">(</span><span class="n">evaporation_data</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</span></code></pre></div>
<p>Explanation:</p>
<p>API Endpoint and Parameters:</p>
<ul>
<li>The function constructs a request to the NASA POWER API's hourly data endpoint for a specific geographic point.</li>
<li>Parameters include the date range (start and end), geographic coordinates (latitude and longitude), the desired parameter (EVAP for evaporation), the user community (AG for agriculture), the response format (JSON), and the time standard (LST for Local Solar Time).</li>
</ul>
<p>Making the Request:</p>
<ul>
<li>The function uses the requests library to send a GET request to the API with the specified parameters.</li>
<li>It checks for successful response status and raises an error if the request was unsuccessful.</li>
</ul>
<p>Processing the Response:</p>
<ul>
<li>The JSON response is parsed to extract the hourly evaporation data located under properties.parameter.EVAP.</li>
<li>This data is converted into a pandas DataFrame, with the timestamps as the index and a column named 'Evaporation'.</li>
<li>The index is converted to datetime objects, and the DataFrame is sorted by the index to ensure chronological order.</li>
</ul>
<p>Note:</p>
<ul>
<li>Ensure that the date range and location provided are within the valid range supported by the NASA POWER API.</li>
<li>The API provides data starting from January 1, 2001, to near real-time.</li>
<li>For more information on the API and its parameters, refer to the NASA POWER API Documentation.</li>
</ul>
<p>By following these steps, you can successfully retrieve and process hourly evaporation data for a specified date range and location using the NASA POWER API.</p>
</details>
</div>
<p><strong>Use LLMs to help with data visualisation, exploration and communication</strong> </p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>You are a senior geospatial analyst. You are generating figures for a public government report. The purpose of the report is to highlight within-field yield variability and the opportunities for precision agriculture to increase crop production. </p>
<p>Can you generate a publication quality figure of an NDVI map for a field with a legend and save it as a PNG file? </p>
<p>Can you explain the design and style choices when presenting information on the map. </p>
<div class="admonition tip">
<p class="admonition-title">Verifying and improving LLM responses</p>
<p>The response generated by Gemini 2.0 Flash below is a good example of why it's important to carefully check the LLM response. Overall, it's provided you with Python code that's a good start and its considered lots of elements of a good quality figure (e.g. scale bar and adding coordinates to the map axes). However, there are places where the model's reasoning is erroneous, such as the suggestion to use a red-yellow-green colour palette because it is colour blind friendly (red and green are indistinguishable for certain types of colour blindness). This LLM response is a good reminder for you to consider the accessibility of your figures and choose appropriate colour palettes, and, also, a reminder to check the LLM's reasoning for errors. </p>
<p>Also, this is a first attempt. Think about how you could improve the figure (e.g. adding a basemap for reference). This is something you could go back to the LLM with and prompt it to update its response to include basemaps. It is good to get into the habit of treating the LLM as a coding assistant that you bounce ideas and tasks off. </p>
</div>
<details class="note">
<summary>Response (Gemini 2.0 Flash)</summary>
<p>I can't directly generate a PNG file and display it here. I'm a text-based AI and don't have the capability to create images. However, I can provide you with the Python code using Matplotlib and a conceptual explanation of how to create such a figure, along with the design considerations for a public government report.  You can then run this code in your own Python environment.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="c1"># Sample NDVI data (replace with your actual data)</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>  <span class="c1"># for reproducibility</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">ndvi_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">))</span>  <span class="c1"># Realistic NDVI range</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="c1"># Create the figure and axes</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>  <span class="c1"># Adjust figure size as needed</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="c1"># Plot the NDVI data as an image</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ndvi_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;RdYlGn&#39;</span><span class="p">),</span>  <span class="c1"># Use a suitable colormap</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>            <span class="n">vmin</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span>  <span class="c1"># Set colorbar limits for consistency</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a>            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cols</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">rows</span><span class="o">*</span><span class="mi">10</span><span class="p">],</span> <span class="c1"># Example: 10m x 10m grid cells</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a>            <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>  <span class="c1"># Ensure correct orientation</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="c1"># Add a colorbar with appropriate labels</span>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>  <span class="c1"># Shrink colorbar if needed</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Normalized Difference Vegetation Index (NDVI)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="c1"># Add a title and axis labels</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Within-Field NDVI Variability&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Easting (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># Example units</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Northing (m)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># Example units</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29" href="#__codelineno-20-29"></a>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30" href="#__codelineno-20-30"></a><span class="c1"># Add a scale bar (example)</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31" href="#__codelineno-20-31"></a><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.anchored_artists</span> <span class="kn">import</span> <span class="n">AnchoredScaleBar</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32" href="#__codelineno-20-32"></a><span class="n">scalebar</span> <span class="o">=</span> <span class="n">AnchoredScaleBar</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;100 m&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33" href="#__codelineno-20-33"></a>                        <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># Adjust length and position</span>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34" href="#__codelineno-20-34"></a><span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">scalebar</span><span class="p">)</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35" href="#__codelineno-20-35"></a>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36" href="#__codelineno-20-36"></a><span class="c1"># Improve plot aesthetics</span>
</span><span id="__span-20-37"><a id="__codelineno-20-37" name="__codelineno-20-37" href="#__codelineno-20-37"></a><span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span> <span class="c1"># Important for geospatial data</span>
</span><span id="__span-20-38"><a id="__codelineno-20-38" name="__codelineno-20-38" href="#__codelineno-20-38"></a><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust spacing</span>
</span><span id="__span-20-39"><a id="__codelineno-20-39" name="__codelineno-20-39" href="#__codelineno-20-39"></a>
</span><span id="__span-20-40"><a id="__codelineno-20-40" name="__codelineno-20-40" href="#__codelineno-20-40"></a><span class="c1"># Save the figure as a PNG</span>
</span><span id="__span-20-41"><a id="__codelineno-20-41" name="__codelineno-20-41" href="#__codelineno-20-41"></a><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;ndvi_map.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># High DPI for publication</span>
</span><span id="__span-20-42"><a id="__codelineno-20-42" name="__codelineno-20-42" href="#__codelineno-20-42"></a>
</span><span id="__span-20-43"><a id="__codelineno-20-43" name="__codelineno-20-43" href="#__codelineno-20-43"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># If you want to display the plot in your IDE</span>
</span></code></pre></div>
<p>Design and Style Choices Explanation:</p>
<ul>
<li>Colormap:  RdYlGn (Red-Yellow-Green) is a common and intuitive colormap for NDVI, where red indicates lower vegetation health, yellow intermediate, and green higher.  It's also generally colorblind-friendly.  Other options like viridis could be considered.</li>
<li>Colorbar Limits: Setting vmin and vmax ensures consistency if you're comparing multiple fields or time periods.  It also prevents the colorbar from being skewed by outliers.  The range 0.2-0.9 is a typical range for NDVI, but you should adjust it based on your data.</li>
<li>Figure Size and DPI:  The figsize and dpi settings control the final image resolution.  300 dpi is generally suitable for print publications.</li>
<li>Axis Labels and Units: Clear and informative labels are crucial.  Include units (e.g., meters, feet) where appropriate.  If your data is in a specific coordinate system (e.g., UTM), mention it in the figure caption or report text.</li>
<li>Title: A concise and descriptive title is essential.</li>
<li>Scale Bar: A scale bar provides context and helps the reader understand the spatial dimensions of the field.</li>
<li>Aspect Ratio: Setting <code>ax.set_aspect('equal')</code> is extremely important for geospatial data. It ensures that the distances on the x and y axes are represented correctly, preventing distortion.</li>
<li>Colorbar Label: The colorbar needs a clear label explaining what the colors represent.</li>
<li>Font Sizes: Use consistent and readable font sizes for all text elements.</li>
<li>Layout: <code>fig.tight_layout()</code> helps prevent labels and titles from overlapping.</li>
<li>Data:  The code uses np.random.uniform to generate sample NDVI data.  Replace this with your actual NDVI data.  Make sure your data is in a format that Matplotlib can handle (e.g., a 2D NumPy array).</li>
<li>Extent: The extent argument in imshow is crucial for correctly positioning your data on the map.  It should correspond to the real-world coordinates of your field.  If you don't provide it, the image will be displayed in pixel coordinates.</li>
</ul>
<p>For a government report:</p>
<ul>
<li>Clarity is paramount: Avoid jargon and explain any technical terms.</li>
<li>Accuracy is essential: Double-check your data and ensure that the map accurately represents the field conditions.</li>
<li>Accessibility: Consider colorblind readers when choosing colormaps.</li>
<li>Context: Provide sufficient background information in the report text to explain the significance of the NDVI map and its implications for precision agriculture. Include information about the field, the date of the imagery, and any other relevant details.</li>
<li>Caption: The figure should have a clear and concise caption that summarizes the key findings.</li>
</ul>
<p>Remember to install the necessary libraries: pip install matplotlib numpy.  Replace the sample data with your own and adjust the parameters as needed. This detailed explanation should allow you to create a publication-quality NDVI map for your report.</p>
</details>
</div>
<p>You can consider using AI to help with more advanced tasks such as creating interactive data visualisations, animations, web pages or dashboards.</p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>I am building a prototype dashboard that will be used to monitor on-farm water resources and crop water requirements. Can you generate an interactive visualisation of a time-series of evaporation data? The evaporation data is stored in a CSV file.</p>
<div class="admonition tip">
<p class="admonition-title">How could you improve this prompt?</p>
<p>This is not a particularly challenging coding task, so it is likely that the model's first response will be pretty close-to-the-mark. However, here are some suggestions for how to improve this prompt:</p>
<ul>
<li>Provide more specifics about the figure you want generated (e.g. colour, themes, styling)</li>
<li>Provide more specifics about the figure's interactive features (e.g. what data do you want in hover pop ups?)</li>
<li>Be more explicit about the LLMs role (e.g. generate the code using web development best-practice)</li>
<li>Encourage the model to think about the task (e.g. you could ask the model to make suggestions on useful interactive features)</li>
<li>Ask the LLM to generate a dummy dataset for you to test the code with, this can speed up your development iterations</li>
<li>Provide more contextual information (e.g. if this is just a prototype, emphasise that you want a simple codebase that's easy to edit after user testing)</li>
</ul>
</div>
<details class="note">
<summary>Response (ChatGPT)</summary>
<p>Below is an example of how you might create an interactive time-series visualization of evaporation data using Plotly and pandas. This example assumes your CSV file has at least two columns (e.g., "Date" and "Evaporation"):</p>
<p><div class="language-python highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="c1"># Load the evaporation data from CSV</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;evaporation_data.csv&#39;</span><span class="p">)</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="c1"># Ensure the &#39;Date&#39; column is interpreted as datetime</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="c1"># Create an interactive line plot for evaporation over time</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Evaporation&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Evaporation Time-Series&#39;</span><span class="p">)</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="c1"># Add a range slider for interactive zooming and panning</span>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>    <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>        <span class="n">rangeselector</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a>            <span class="n">buttons</span><span class="o">=</span><span class="nb">list</span><span class="p">([</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a>                <span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1d&quot;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="n">stepmode</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">),</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>                <span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1w&quot;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="n">stepmode</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">),</span>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a>                <span class="nb">dict</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;1m&quot;</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">,</span> <span class="n">stepmode</span><span class="o">=</span><span class="s2">&quot;backward&quot;</span><span class="p">),</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a>                <span class="nb">dict</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>            <span class="p">])</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>        <span class="p">),</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>        <span class="n">rangeslider</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;date&quot;</span>
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a>    <span class="p">)</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a><span class="p">)</span>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="c1"># Display the interactive plot</span>
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
Step-by-Step Explanation</p>
<p>Import Libraries:</p>
<ul>
<li>pandas is used to load and process the CSV data.</li>
<li>plotly.express is used to quickly create interactive plots.</li>
</ul>
<p>Load the Data:</p>
<ul>
<li>The CSV file is read into a pandas DataFrame using pd.read_csv(). Make sure your file path is correct.</li>
</ul>
<p>Data Preprocessing:</p>
<ul>
<li>The "Date" column is converted to a datetime object with pd.to_datetime() to ensure proper time-series handling.</li>
</ul>
<p>Create the Interactive Plot:</p>
<ul>
<li>A line plot is created using px.line(), specifying the x-axis as "Date" and the y-axis as "Evaporation".</li>
<li>A title is added to make the chart self-explanatory.</li>
</ul>
<p>Enhance Interactivity:</p>
<ul>
<li>A range selector and range slider are added using fig.update_layout(). This allows users to quickly zoom in on specific periods or pan across the timeline.</li>
</ul>
<p>Display the Plot:</p>
<ul>
<li>Finally, fig.show() renders the interactive visualization in a web browser or an interactive environment (like Jupyter Notebook).</li>
</ul>
<p>This interactive visualization can be embedded in your prototype dashboard, providing users with an intuitive tool to monitor changes in evaporation over time.</p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Using best practice web development techniques and open-source packages, create a web dashboard that displays weather data for a location that a user clicks on a web map? When a user clicks on a location add a marker to the map and bring up a popup window that displays current temperature, precipitation, windspeed and humidity. </p>
<p>Can you provide detailed instructions for how to deploy and test this dashboard?</p>
<div class="admonition tip">
<p class="admonition-title">Use thinking and reasoning models for complex tasks</p>
<p>This is a complex tasks comrpising a series of steps and discrete sub-tasks (e.g. building the frontend web map user interface, code to handle user interactions, building a backend server to make fetch weather data on the fly, detailed instructions for deployment). There are different ways to complete these tasks (e.g. choices between different software packages, design and styling choices and the choices between technical deployment solutions); the model needs to consider these different options and make a decision on the solution when generating a response. The nature of this task (comprising multiple problems and consideration of multiple options) makes it well suited to "thinking" or "reasoning" models. </p>
<p>Compare these two responses, one using regular ChatGPT and the other using Gemini 2.0 Flash Thinking with reasoning turned on. ChatGPT without thinking has generated a good first start and a template that you could build on. However, contrast this to the response generated by Gemini 2.0 Flash Thinking which has provided a lot of extra and useful detail:</p>
<ul>
<li>detailed instructions on installing software and packages </li>
<li>detailed instructions on how to deploy the dashboard to the cloud/ servers</li>
<li>recognised the need for development and production environments</li>
<li>justification for suggested software packages and deployment environments</li>
<li>suggestions for styling and enhancement</li>
<li>suggestions for testing the user interface and backend servers</li>
</ul>
</div>
<details class="note">
<summary>Respone (ChatGPT)</summary>
<p>Heres how to build a web dashboard that displays weather data when a user clicks on a map. The dashboard will use React (Next.js) for the frontend and FastAPI for the backend to fetch weather data from an open-source API like OpenWeatherMap. We'll also use Leaflet.js for the interactive map and Tailwind CSS for styling.</p>
<p>Project Overview</p>
<p>When a user clicks on a location:</p>
<p> A marker is added to the map.
 A popup appears with current temperature, precipitation, windspeed, and humidity.
 Weather data is fetched dynamically from an API.</p>
<p>Tech Stack</p>
<p>Frontend: React (Next.js), Leaflet.js, Tailwind CSS
Backend: FastAPI (Python)
API: OpenWeatherMap API
Deployment: Vercel (Frontend) + Railway/Render (Backend)</p>
<p>Code Implementation</p>
<p>Step 1: Set Up the Backend (FastAPI)</p>
<p>First, install FastAPI and Uvicorn:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>pip install fastapi uvicorn requests
</span></code></pre></div>
<p>Create a file backend/main.py:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="kn">from</span> <span class="nn">fastapi.middleware.cors</span> <span class="kn">import</span> <span class="n">CORSMiddleware</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="c1"># Allow frontend to access the backend</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="n">app</span><span class="o">.</span><span class="n">add_middleware</span><span class="p">(</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>    <span class="n">CORSMiddleware</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>    <span class="n">allow_origins</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>    <span class="n">allow_credentials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>    <span class="n">allow_methods</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>    <span class="n">allow_headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;*&quot;</span><span class="p">],</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="p">)</span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="c1"># Replace with your OpenWeatherMap API Key</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="n">API_KEY</span> <span class="o">=</span> <span class="s2">&quot;YOUR_OPENWEATHERMAP_API_KEY&quot;</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/weather/&quot;</span><span class="p">)</span>
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="k">def</span> <span class="nf">get_weather</span><span class="p">(</span><span class="n">lat</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">lon</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetch current weather data for given lat/lon.&quot;&quot;&quot;</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://api.openweathermap.org/data/2.5/weather?lat=</span><span class="si">{</span><span class="n">lat</span><span class="si">}</span><span class="s2">&amp;lon=</span><span class="si">{</span><span class="n">lon</span><span class="si">}</span><span class="s2">&amp;units=metric&amp;appid=</span><span class="si">{</span><span class="n">API_KEY</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a>
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Unable to fetch weather data&quot;</span><span class="p">}</span>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a>
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a>    <span class="k">return</span> <span class="p">{</span>
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a>        <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">][</span><span class="s2">&quot;temp&quot;</span><span class="p">],</span>
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>        <span class="s2">&quot;humidity&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;main&quot;</span><span class="p">][</span><span class="s2">&quot;humidity&quot;</span><span class="p">],</span>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a>        <span class="s2">&quot;windspeed&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;wind&quot;</span><span class="p">][</span><span class="s2">&quot;speed&quot;</span><span class="p">],</span>
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a>        <span class="s2">&quot;precipitation&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;weather&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">],</span>
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a>    <span class="p">}</span>
</span></code></pre></div>
<p>Run the backend server with: <code>uvicorn main:app --reload</code></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>uvicorn main:app --reload
</span></code></pre></div>
<p>The API is now running at http://127.0.0.1:8000/weather/.</p>
<p>Step 2: Set Up the Frontend (Next.js + Leaflet)</p>
<p>Create a Next.js project:</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="nx">npx</span><span class="w"> </span><span class="nx">create</span><span class="o">-</span><span class="nx">next</span><span class="o">-</span><span class="nx">app</span><span class="w"> </span><span class="nx">frontend</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="nx">cd</span><span class="w"> </span><span class="nx">frontend</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="nx">npm</span><span class="w"> </span><span class="nx">install</span><span class="w"> </span><span class="nx">leaflet</span><span class="w"> </span><span class="nx">react</span><span class="o">-</span><span class="nx">leaflet</span><span class="w"> </span><span class="nx">axios</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="nx">Create</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="nx">frontend</span><span class="o">/</span><span class="nx">components</span><span class="o">/</span><span class="nb">Map</span><span class="p">.</span><span class="nx">js</span><span class="o">:</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react&quot;</span><span class="p">;</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">MapContainer</span><span class="p">,</span><span class="w"> </span><span class="nx">TileLayer</span><span class="p">,</span><span class="w"> </span><span class="nx">Marker</span><span class="p">,</span><span class="w"> </span><span class="nx">useMapEvents</span><span class="p">,</span><span class="w"> </span><span class="nx">Popup</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;react-leaflet&quot;</span><span class="p">;</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a><span class="k">import</span><span class="w"> </span><span class="nx">axios</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;axios&quot;</span><span class="p">;</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="kd">const</span><span class="w"> </span><span class="nx">MapComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">position</span><span class="p">,</span><span class="w"> </span><span class="nx">setPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">weather</span><span class="p">,</span><span class="w"> </span><span class="nx">setWeather</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a><span class="kd">const</span><span class="w"> </span><span class="nx">fetchWeather</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lon</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`http://127.0.0.1:8000/weather/?lat=</span><span class="si">${</span><span class="nx">lat</span><span class="si">}</span><span class="sb">&amp;lon=</span><span class="si">${</span><span class="nx">lon</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a><span class="w">    </span><span class="nx">setWeather</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Failed to fetch weather data&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="p">};</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a><span class="kd">function</span><span class="w"> </span><span class="nx">LocationMarker</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a><span class="w">    </span><span class="nx">useMapEvents</span><span class="p">({</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a><span class="w">    </span><span class="nx">click</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">latlng</span><span class="p">;</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a><span class="w">        </span><span class="nx">setPosition</span><span class="p">([</span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="p">]);</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a><span class="w">        </span><span class="nx">fetchWeather</span><span class="p">(</span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="p">);</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a><span class="w">    </span><span class="p">});</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">position</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">Marker</span><span class="w"> </span><span class="nx">position</span><span class="o">=</span><span class="p">{</span><span class="nx">position</span><span class="p">}</span><span class="o">&gt;</span>
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a><span class="w">        </span><span class="o">&lt;</span><span class="nx">Popup</span><span class="o">&gt;</span>
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a><span class="w">        </span><span class="p">{</span><span class="nx">weather</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a><span class="w">            </span><span class="o">&lt;&gt;</span>
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a><span class="w">            </span><span class="o">&lt;</span><span class="nx">b</span><span class="o">&gt;</span><span class="nx">Weather</span><span class="w"> </span><span class="nx">Info</span><span class="o">&lt;</span><span class="err">/b&gt;</span>
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a><span class="w">            </span><span class="o">&lt;</span><span class="nx">br</span><span class="w"> </span><span class="o">/&gt;</span><span class="w"> </span><span class="err"></span><span class="w"> </span><span class="nx">Temp</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weather</span><span class="p">.</span><span class="nx">temperature</span><span class="p">}</span><span class="err"></span><span class="nx">C</span>
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a><span class="w">            </span><span class="o">&lt;</span><span class="nx">br</span><span class="w"> </span><span class="o">/&gt;</span><span class="w"> </span><span class="err"></span><span class="w"> </span><span class="nx">Humidity</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weather</span><span class="p">.</span><span class="nx">humidity</span><span class="p">}</span><span class="o">%</span>
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a><span class="w">            </span><span class="o">&lt;</span><span class="nx">br</span><span class="w"> </span><span class="o">/&gt;</span><span class="w"> </span><span class="err"></span><span class="w"> </span><span class="nx">Wind</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weather</span><span class="p">.</span><span class="nx">windspeed</span><span class="p">}</span><span class="w"> </span><span class="nx">m</span><span class="o">/</span><span class="nx">s</span>
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a><span class="w">            </span><span class="o">&lt;</span><span class="nx">br</span><span class="w"> </span><span class="o">/&gt;</span><span class="w"> </span><span class="err"></span><span class="w"> </span><span class="nx">Precip</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weather</span><span class="p">.</span><span class="nx">precipitation</span><span class="p">}</span>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a><span class="w">            </span><span class="o">&lt;</span><span class="err">/&gt;</span>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a><span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a><span class="w">            </span><span class="s2">&quot;Fetching weather...&quot;</span>
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a><span class="w">        </span><span class="p">)}</span>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a><span class="w">        </span><span class="o">&lt;</span><span class="err">/Popup&gt;</span>
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a><span class="w">    </span><span class="o">&lt;</span><span class="err">/Marker&gt;</span>
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
</span><span id="__span-25-49"><a id="__codelineno-25-49" name="__codelineno-25-49" href="#__codelineno-25-49"></a><span class="p">}</span>
</span><span id="__span-25-50"><a id="__codelineno-25-50" name="__codelineno-25-50" href="#__codelineno-25-50"></a>
</span><span id="__span-25-51"><a id="__codelineno-25-51" name="__codelineno-25-51" href="#__codelineno-25-51"></a><span class="k">return</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-25-52"><a id="__codelineno-25-52" name="__codelineno-25-52" href="#__codelineno-25-52"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">MapContainer</span><span class="w"> </span><span class="nx">center</span><span class="o">=</span><span class="p">{[</span><span class="mf">51.505</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.09</span><span class="p">]}</span><span class="w"> </span><span class="nx">zoom</span><span class="o">=</span><span class="p">{</span><span class="mf">5</span><span class="p">}</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;500px&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;100%&quot;</span><span class="w"> </span><span class="p">}}</span><span class="o">&gt;</span>
</span><span id="__span-25-53"><a id="__codelineno-25-53" name="__codelineno-25-53" href="#__codelineno-25-53"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">TileLayer</span><span class="w"> </span><span class="nx">url</span><span class="o">=</span><span class="s2">&quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;</span><span class="w"> </span><span class="o">/&gt;</span>
</span><span id="__span-25-54"><a id="__codelineno-25-54" name="__codelineno-25-54" href="#__codelineno-25-54"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">LocationMarker</span><span class="w"> </span><span class="o">/&gt;</span>
</span><span id="__span-25-55"><a id="__codelineno-25-55" name="__codelineno-25-55" href="#__codelineno-25-55"></a><span class="w">    </span><span class="o">&lt;</span><span class="err">/MapContainer&gt;</span>
</span><span id="__span-25-56"><a id="__codelineno-25-56" name="__codelineno-25-56" href="#__codelineno-25-56"></a><span class="p">);</span>
</span><span id="__span-25-57"><a id="__codelineno-25-57" name="__codelineno-25-57" href="#__codelineno-25-57"></a><span class="p">};</span>
</span><span id="__span-25-58"><a id="__codelineno-25-58" name="__codelineno-25-58" href="#__codelineno-25-58"></a>
</span><span id="__span-25-59"><a id="__codelineno-25-59" name="__codelineno-25-59" href="#__codelineno-25-59"></a><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">MapComponent</span><span class="p">;</span>
</span></code></pre></div>
<p>Step 3: Integrate the Map in Next.js</p>
<p>Modify frontend/pages/index.js:</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">import</span><span class="w"> </span><span class="nx">dynamic</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s2">&quot;next/dynamic&quot;</span><span class="p">;</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">MapComponent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dynamic</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">import</span><span class="p">(</span><span class="s2">&quot;../components/Map&quot;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">ssr</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Home</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="k">return</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;flex flex-col items-center justify-center h-screen&quot;</span><span class="o">&gt;</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">h1</span><span class="w"> </span><span class="nx">className</span><span class="o">=</span><span class="s2">&quot;text-2xl font-bold mb-4&quot;</span><span class="o">&gt;</span><span class="nx">On</span><span class="o">-</span><span class="nx">Farm</span><span class="w"> </span><span class="nx">Weather</span><span class="w"> </span><span class="nx">Dashboard</span><span class="o">&lt;</span><span class="err">/h1&gt;</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="w">    </span><span class="o">&lt;</span><span class="nx">MapComponent</span><span class="w"> </span><span class="o">/&gt;</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a><span class="w">    </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="p">);</span>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="p">}</span>
</span></code></pre></div>
<ol>
<li>Running &amp; Testing the Dashboard</li>
</ol>
<p>Start the Backend</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>cd backend
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>uvicorn main:app --reload
</span></code></pre></div>
<p>Start the Frontend</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>cd frontend
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>npm run dev
</span></code></pre></div>
<p>Open http://localhost:3000, click anywhere on the map, and see the weather data popup!</p>
<ol>
<li>Deploying the Dashboard</li>
</ol>
<p>Deploy Backend (FastAPI)</p>
<ul>
<li>
<p>Use Railway, Render, or Fly.io for FastAPI deployment.</p>
</li>
<li>
<p>Example using Railway:</p>
</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>railway init
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>railway up
</span></code></pre></div>
<ul>
<li>Update frontend/components/Map.js to use the live API URL.</li>
</ul>
<p>Deploy Frontend (Next.js)</p>
<ul>
<li>Deploy to Vercel:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>vercel
</span></code></pre></div>
<ul>
<li>
<p>Update API endpoint in the frontend with the deployed FastAPI URL.</p>
</li>
<li>
<p>Enhancements &amp; Future Improvements</p>
</li>
</ul>
<p> Add weather forecasts for the next few days
 Store user locations for analysis
 Integrate satellite imagery for farm monitoring</p>
<p>This setup ensures best practices in modern web development, leveraging open-source packages for interactivity and real-time data updates. </p>
</details>
<details class="note">
<summary>Response (Google 2.0 Flash Thinking)</summary>
<p>Okay, let's create a detailed guide to build your interactive weather dashboard. We'll use best practices by structuring our project, using modern tools, and focusing on maintainability and scalability.</p>
<p>Project Goal:  A web dashboard with a map. Users click on the map, a marker appears, and a popup displays weather data for that location.</p>
<p>Technology Stack (Open Source &amp; Best Practice):</p>
<p>Frontend:</p>
<ul>
<li>React: A popular JavaScript library for building user interfaces. It's component-based, efficient, and well-supported. (Best Practice for modern web UIs)</li>
<li>Leaflet: A lightweight, open-source JavaScript library for interactive maps. It's easy to use and has great performance. (Best Practice for map integration)</li>
<li>React Leaflet: React components for Leaflet, making integration seamless within React.</li>
<li>Axios: A promise-based HTTP client for making API requests from the frontend. (Best Practice for API interaction)</li>
<li>CSS Modules or Styled Components: For styling components in a modular and maintainable way. (Best Practice for CSS management)</li>
</ul>
<p>Backend (Simple API - for this example):</p>
<ul>
<li>Node.js with Express: A minimal and flexible Node.js web application framework. Easy to set up a simple API. (Open Source and good for backend flexibility)</li>
<li>OpenWeatherMap API: A widely used weather API (free tier available for development) to fetch weather data. (Open Source data source - requires API key)
Deployment:</li>
</ul>
<p>Netlify or Vercel (Frontend): Easy and free static site hosting for React frontends. (Best Practice for frontend deployment)
PythonAnywhere, Heroku, or Render (Backend): Platforms for deploying simple backend applications (free or low-cost tiers for initial deployment). (Best Practice for backend deployment)
Step-by-Step Instructions:</p>
<p>Phase 1: Project Setup and Backend API (Node.js with Express)</p>
<p>Set up your Development Environment:</p>
<ul>
<li>Install Node.js and npm (or yarn): Make sure you have Node.js and npm (Node Package Manager) installed on your machine. Download from https://nodejs.org/.</li>
<li>Choose a Code Editor: VS Code, Sublime Text, Atom, etc. (VS Code is highly recommended for React development).</li>
<li>Create Backend Folder and Initialize Node.js Project:</li>
</ul>
<p>Open your terminal and create a folder for your backend (e.g., weather-dashboard-backend):</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>mkdir weather-dashboard-backend
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>cd weather-dashboard-backend
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>npm init -y  # Initializes a Node.js project with default settings
</span></code></pre></div>
<p>Install Backend Dependencies:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>npm install express cors dotenv node-fetch
</span></code></pre></div>
<ul>
<li>express: For creating the API server.</li>
<li>cors: For enabling Cross-Origin Resource Sharing (so your frontend can access the backend).</li>
<li>dotenv: To load environment variables (like your API key) from a <code>.env</code> file.</li>
<li>node-fetch: To make HTTP requests to the OpenWeatherMap API (built-in fetch in newer Node.js versions is also an option)</li>
</ul>
<p>Create .env file:</p>
<ul>
<li>In your <code>weather-dashboard-backend</code> folder, create a file named <code>.env</code>.</li>
<li>Sign up for an account at https://openweathermap.org/api and get an API key.</li>
<li>Add your API key to the .env file:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>OPENWEATHERMAP_API_KEY=YOUR_API_KEY_HERE
</span></code></pre></div>
<p>Create server.js (or index.js) for your Express API:</p>
<div class="language-js highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c1">// server.js (or index.js)</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;dotenv&#39;</span><span class="p">).</span><span class="nx">config</span><span class="p">();</span><span class="w"> </span><span class="c1">// Load environment variables from .env</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express&#39;</span><span class="p">);</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="kd">const</span><span class="w"> </span><span class="nx">cors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;cors&#39;</span><span class="p">);</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="kd">const</span><span class="w"> </span><span class="nx">fetch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;node-fetch&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// or use built-in fetch</span>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="kd">const</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PORT</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="mf">5000</span><span class="p">;</span><span class="w"> </span><span class="c1">// Use PORT env variable if available, otherwise default to 5000</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">cors</span><span class="p">());</span><span class="w"> </span><span class="c1">// Enable CORS for all origins (for development - refine for production)</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="nx">app</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">req</span><span class="p">,</span><span class="w"> </span><span class="nx">res</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lon</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">;</span><span class="w"> </span><span class="c1">// Get latitude and longitude from query parameters</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">lat</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">lon</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">400</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Latitude and longitude are required.&#39;</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">apiKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">OPENWEATHERMAP_API_KEY</span><span class="p">;</span>
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">apiUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`https://api.openweathermap.org/data/2.5/weather?lat=&lt;span class=&quot;math-inline&quot;&gt;\{lat\}&amp;lon\=&lt;/span&gt;{lon}&amp;appid=</span><span class="si">${</span><span class="nx">apiKey</span><span class="si">}</span><span class="sb">&amp;units=metric`</span><span class="p">;</span><span class="w"> </span><span class="c1">// Use metric units</span>
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a><span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="nx">apiUrl</span><span class="p">);</span>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="sb">`HTTP error! status: </span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">weatherData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a><span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">weatherData</span><span class="p">);</span>
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error fetching weather data:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="w">        </span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mf">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to fetch weather data.&#39;</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a><span class="p">});</span>
</span><span id="__span-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a>
</span><span id="__span-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a><span class="nx">app</span><span class="p">.</span><span class="nx">listen</span><span class="p">(</span><span class="nx">port</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a><span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`Server listening on port </span><span class="si">${</span><span class="nx">port</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span><span id="__span-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a><span class="p">});</span>
</span></code></pre></div>
<p>Run the Backend API:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>node server.js  # or node index.js if you named it index.js
</span></code></pre></div>
<p>Your backend API should be running on http://localhost:5000.</p>
<p>Test the Backend API:</p>
<ul>
<li>Open a browser or use a tool like Postman/curl.</li>
<li>Access the endpoint with latitude and longitude parameters, e.g.,: http://localhost:5000/weather?lat=51.5074&amp;lon=0.1278 (London coordinates)</li>
<li>You should see a JSON response with weather data from OpenWeatherMap.</li>
</ul>
<p>Phase 2: Frontend Setup (React) and Map Integration</p>
<p>Create Frontend Folder and React App:</p>
<p>In the same parent directory as your <code>weather-dashboard-backend</code> folder, create a frontend folder (e.g., <code>weather-dashboard-frontend</code>):</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>npx create-react-app weather-dashboard-frontend
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>cd weather-dashboard-frontend
</span></code></pre></div>
<p>This uses create-react-app (CRA), a best practice for quickly setting up a React project.</p>
<p>Install Frontend Dependencies:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>npm install leaflet react-leaflet axios
</span></code></pre></div>
<ul>
<li>leaflet: Leaflet library.</li>
<li>react-leaflet: React components for Leaflet.</li>
<li>axios: For making API requests to your backend.</li>
</ul>
<p>Clean up src folder:</p>
<ul>
<li>Delete unnecessary files from src like <code>App.css</code>, <code>logo.svg</code>, <code>reportWebVitals.js</code>, <code>setupTests.js</code>.</li>
<li>Modify <code>index.js</code> to just render App component.</li>
<li>Modify <code>App.js</code> (Basic Map Component):</li>
</ul>
<p><div class="language-js highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c1">// src/App.js</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="k">import</span><span class="w"> </span><span class="nx">React</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">useState</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">MapContainer</span><span class="p">,</span><span class="w"> </span><span class="nx">TileLayer</span><span class="p">,</span><span class="w"> </span><span class="nx">Marker</span><span class="p">,</span><span class="w"> </span><span class="nx">Popup</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;react-leaflet&#39;</span><span class="p">;</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="k">import</span><span class="w"> </span><span class="s1">&#39;leaflet/dist/leaflet.css&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Import Leaflet CSS</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="k">import</span><span class="w"> </span><span class="nx">axios</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;axios&#39;</span><span class="p">;</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="k">import</span><span class="w"> </span><span class="nx">L</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;leaflet&#39;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Import Leaflet for icon fix</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="c1">// Fix for Leaflet marker icon issue (if needed - sometimes CRA and Leaflet conflict)</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="ow">delete</span><span class="w"> </span><span class="nx">L</span><span class="p">.</span><span class="nx">Icon</span><span class="p">.</span><span class="nx">Default</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_getIconUrl</span><span class="p">;</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="nx">L</span><span class="p">.</span><span class="nx">Icon</span><span class="p">.</span><span class="nx">Default</span><span class="p">.</span><span class="nx">mergeOptions</span><span class="p">({</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="w">    </span><span class="nx">iconRetinaUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;leaflet/dist/images/marker-icon-2x.png&#39;</span><span class="p">),</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="w">    </span><span class="nx">iconUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;leaflet/dist/images/marker-icon.png&#39;</span><span class="p">),</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="w">    </span><span class="nx">shadowUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;leaflet/dist/images/marker-shadow.png&#39;</span><span class="p">)</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="p">});</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="kd">function</span><span class="w"> </span><span class="nx">App</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">markerPosition</span><span class="p">,</span><span class="w"> </span><span class="nx">setMarkerPosition</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">[</span><span class="nx">weatherData</span><span class="p">,</span><span class="w"> </span><span class="nx">setWeatherData</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">useState</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a>
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a><span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">handleMapClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a><span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">latlng</span><span class="p">;</span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a><span class="w">        </span><span class="nx">setMarkerPosition</span><span class="p">({</span><span class="w"> </span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lng</span><span class="w"> </span><span class="p">});</span>
</span><span id="__span-38-24"><a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>
</span><span id="__span-38-25"><a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-26"><a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a><span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">axios</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;http://localhost:5000/weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Adjust backend URL if needed</span>
</span><span id="__span-38-27"><a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a><span class="w">                </span><span class="nx">params</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">lon</span><span class="o">:</span><span class="w"> </span><span class="nx">lng</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-38-28"><a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a><span class="w">            </span><span class="p">});</span>
</span><span id="__span-38-29"><a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a><span class="w">            </span><span class="nx">setWeatherData</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
</span><span id="__span-38-30"><a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-31"><a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a><span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;Error fetching weather data:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
</span><span id="__span-38-32"><a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a><span class="w">            </span><span class="nx">setWeatherData</span><span class="p">({</span><span class="w"> </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Failed to fetch weather data&#39;</span><span class="w"> </span><span class="p">});</span><span class="w"> </span><span class="c1">// Set an error state</span>
</span><span id="__span-38-33"><a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-38-34"><a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a><span class="w">    </span><span class="p">};</span>
</span><span id="__span-38-35"><a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a>
</span><span id="__span-38-36"><a id="__codelineno-38-36" name="__codelineno-38-36" href="#__codelineno-38-36"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-38-37"><a id="__codelineno-38-37" name="__codelineno-38-37" href="#__codelineno-38-37"></a><span class="w">        </span><span class="o">&lt;</span><span class="nx">div</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;100vh&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;100%&#39;</span><span class="w"> </span><span class="p">}}</span><span class="o">&gt;</span>
</span><span id="__span-38-38"><a id="__codelineno-38-38" name="__codelineno-38-38" href="#__codelineno-38-38"></a><span class="w">            </span><span class="o">&lt;</span><span class="nx">MapContainer</span><span class="w"> </span><span class="nx">center</span><span class="o">=</span><span class="p">{[</span><span class="mf">51.505</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">0.09</span><span class="p">]}</span><span class="w"> </span><span class="nx">zoom</span><span class="o">=</span><span class="p">{</span><span class="mf">13</span><span class="p">}</span><span class="w"> </span><span class="nx">style</span><span class="o">=</span><span class="p">{{</span><span class="w"> </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;100%&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;100%&#39;</span><span class="w"> </span><span class="p">}}</span><span class="w"> </span><span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">handleMapClick</span><span class="p">}</span><span class="o">&gt;</span>
</span><span id="__span-38-39"><a id="__codelineno-38-39" name="__codelineno-38-39" href="#__codelineno-38-39"></a><span class="w">                </span><span class="o">&lt;</span><span class="nx">TileLayer</span>
</span><span id="__span-38-40"><a id="__codelineno-38-40" name="__codelineno-38-40" href="#__codelineno-38-40"></a><span class="w">                    </span><span class="nx">url</span><span class="o">=</span><span class="s2">&quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;</span>
</span><span id="__span-38-41"><a id="__codelineno-38-41" name="__codelineno-38-41" href="#__codelineno-38-41"></a><span class="w">                    </span><span class="nx">attribution</span><span class="o">=</span><span class="s1">&#39;&amp;copy; &lt;a href=&quot;https://www.openstreetmap.org/copyright&quot;&gt;OpenStreetMap&lt;/a&gt; contributors&#39;</span>
</span><span id="__span-38-42"><a id="__codelineno-38-42" name="__codelineno-38-42" href="#__codelineno-38-42"></a><span class="w">                </span><span class="o">/&gt;</span>
</span><span id="__span-38-43"><a id="__codelineno-38-43" name="__codelineno-38-43" href="#__codelineno-38-43"></a><span class="w">                </span><span class="p">{</span><span class="nx">markerPosition</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-38-44"><a id="__codelineno-38-44" name="__codelineno-38-44" href="#__codelineno-38-44"></a><span class="w">                    </span><span class="o">&lt;</span><span class="nx">Marker</span><span class="w"> </span><span class="nx">position</span><span class="o">=</span><span class="p">{[</span><span class="nx">markerPosition</span><span class="p">.</span><span class="nx">lat</span><span class="p">,</span><span class="w"> </span><span class="nx">markerPosition</span><span class="p">.</span><span class="nx">lng</span><span class="p">]}</span><span class="o">&gt;</span>
</span><span id="__span-38-45"><a id="__codelineno-38-45" name="__codelineno-38-45" href="#__codelineno-38-45"></a><span class="w">                        </span><span class="o">&lt;</span><span class="nx">Popup</span><span class="o">&gt;</span>
</span><span id="__span-38-46"><a id="__codelineno-38-46" name="__codelineno-38-46" href="#__codelineno-38-46"></a><span class="w">                            </span><span class="p">{</span><span class="nx">weatherData</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-38-47"><a id="__codelineno-38-47" name="__codelineno-38-47" href="#__codelineno-38-47"></a><span class="w">                                </span><span class="nx">weatherData</span><span class="p">.</span><span class="nx">error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-38-48"><a id="__codelineno-38-48" name="__codelineno-38-48" href="#__codelineno-38-48"></a><span class="w">                                    </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="ne">Error</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weatherData</span><span class="p">.</span><span class="nx">error</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span id="__span-38-49"><a id="__codelineno-38-49" name="__codelineno-38-49" href="#__codelineno-38-49"></a><span class="w">                                </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-38-50"><a id="__codelineno-38-50" name="__codelineno-38-50" href="#__codelineno-38-50"></a><span class="w">                                    </span><span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span>
</span><span id="__span-38-51"><a id="__codelineno-38-51" name="__codelineno-38-51" href="#__codelineno-38-51"></a><span class="w">                                        </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Temperature</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weatherData</span><span class="p">.</span><span class="nx">main</span><span class="o">?</span><span class="p">.</span><span class="nx">temp</span><span class="p">}</span><span class="err"></span><span class="nx">C</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span id="__span-38-52"><a id="__codelineno-38-52" name="__codelineno-38-52" href="#__codelineno-38-52"></a><span class="w">                                        </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Description</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weatherData</span><span class="p">.</span><span class="nx">weather</span><span class="o">?</span><span class="p">.[</span><span class="mf">0</span><span class="p">]</span><span class="o">?</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span id="__span-38-53"><a id="__codelineno-38-53" name="__codelineno-38-53" href="#__codelineno-38-53"></a><span class="w">                                        </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Wind</span><span class="w"> </span><span class="nx">Speed</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weatherData</span><span class="p">.</span><span class="nx">wind</span><span class="o">?</span><span class="p">.</span><span class="nx">speed</span><span class="p">}</span><span class="w"> </span><span class="nx">m</span><span class="o">/</span><span class="nx">s</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span id="__span-38-54"><a id="__codelineno-38-54" name="__codelineno-38-54" href="#__codelineno-38-54"></a><span class="w">                                        </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Humidity</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="nx">weatherData</span><span class="p">.</span><span class="nx">main</span><span class="o">?</span><span class="p">.</span><span class="nx">humidity</span><span class="p">}</span><span class="o">%&lt;</span><span class="err">/p&gt;</span>
</span><span id="__span-38-55"><a id="__codelineno-38-55" name="__codelineno-38-55" href="#__codelineno-38-55"></a><span class="w">                                        </span><span class="p">{</span><span class="cm">/* Add more weather data as needed */</span><span class="p">}</span>
</span><span id="__span-38-56"><a id="__codelineno-38-56" name="__codelineno-38-56" href="#__codelineno-38-56"></a><span class="w">                                    </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span id="__span-38-57"><a id="__codelineno-38-57" name="__codelineno-38-57" href="#__codelineno-38-57"></a><span class="w">                                </span><span class="p">)</span>
</span><span id="__span-38-58"><a id="__codelineno-38-58" name="__codelineno-38-58" href="#__codelineno-38-58"></a><span class="w">                            </span><span class="p">)</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-38-59"><a id="__codelineno-38-59" name="__codelineno-38-59" href="#__codelineno-38-59"></a><span class="w">                                </span><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">Loading</span><span class="w"> </span><span class="nx">weather</span><span class="w"> </span><span class="nx">data</span><span class="p">...</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span id="__span-38-60"><a id="__codelineno-38-60" name="__codelineno-38-60" href="#__codelineno-38-60"></a><span class="w">                            </span><span class="p">)}</span>
</span><span id="__span-38-61"><a id="__codelineno-38-61" name="__codelineno-38-61" href="#__codelineno-38-61"></a><span class="w">                        </span><span class="o">&lt;</span><span class="err">/Popup&gt;</span>
</span><span id="__span-38-62"><a id="__codelineno-38-62" name="__codelineno-38-62" href="#__codelineno-38-62"></a><span class="w">                    </span><span class="o">&lt;</span><span class="err">/Marker&gt;</span>
</span><span id="__span-38-63"><a id="__codelineno-38-63" name="__codelineno-38-63" href="#__codelineno-38-63"></a><span class="w">                </span><span class="p">)}</span>
</span><span id="__span-38-64"><a id="__codelineno-38-64" name="__codelineno-38-64" href="#__codelineno-38-64"></a><span class="w">            </span><span class="o">&lt;</span><span class="err">/MapContainer&gt;</span>
</span><span id="__span-38-65"><a id="__codelineno-38-65" name="__codelineno-38-65" href="#__codelineno-38-65"></a><span class="w">        </span><span class="o">&lt;</span><span class="err">/div&gt;</span>
</span><span id="__span-38-66"><a id="__codelineno-38-66" name="__codelineno-38-66" href="#__codelineno-38-66"></a><span class="w">    </span><span class="p">);</span>
</span><span id="__span-38-67"><a id="__codelineno-38-67" name="__codelineno-38-67" href="#__codelineno-38-67"></a><span class="p">}</span>
</span><span id="__span-38-68"><a id="__codelineno-38-68" name="__codelineno-38-68" href="#__codelineno-38-68"></a>
</span><span id="__span-38-69"><a id="__codelineno-38-69" name="__codelineno-38-69" href="#__codelineno-38-69"></a><span class="k">export</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="nx">App</span><span class="p">;</span>
</span></code></pre></div>
* Your frontend app should be running on http://localhost:3000.</p>
<p>Test the Dashboard:</p>
<ul>
<li>Open http://localhost:3000 in your browser.  </li>
<li>Click on the map.</li>
<li>A marker should appear, and after a moment, a popup should display weather data for that location.</li>
<li>If you see "Loading weather data..." and it doesn't resolve, check your backend API is running correctly, and your API key is valid.  </li>
<li>Inspect the browser's developer console (F12) for any errors (Network, Console tabs).</li>
</ul>
<p>Phase 3: Styling and Enhancements (Optional but Recommended Best Practices)</p>
<p>Styling:  </p>
<ul>
<li>CSS Modules: In <code>App.js</code>, you can create <code>App.module.css</code> file for component-specific styling and import it: <code>import styles from './App.module.css';</code> and use class names like <code>className={styles.mapContainer}</code>.  </li>
<li>Styled Components: Install <code>npm install styled-components</code> and use them to create styled components within your React code.</li>
<li>Tailwind CSS: Install <code>npm install -D tailwindcss postcss autoprefixer</code> and configure Tailwind CSS for rapid utility-first styling.</li>
</ul>
<p>Enhancements (Best Practices):</p>
<ul>
<li>Error Handling: Improve error messages in popups.</li>
<li>Loading States: Implement better loading indicators (spinners).</li>
<li>UI/UX Improvements: Design a better popup, maybe use icons for weather conditions, make the map responsive.</li>
<li>Caching: Implement client-side or server-side caching to reduce API calls for frequently clicked locations.</li>
<li>Input Field for Location Search: Add a search bar using a geocoding service (like OpenStreetMap Nominatim or Google Maps Geocoding API) to allow users to search for locations by name and then click on the map.</li>
<li>More Weather Data: Display more relevant weather information from the OpenWeatherMap API response (sunrise/sunset, feels like temperature, pressure, etc.).</li>
<li>Weather Icons: Use weather condition codes from OpenWeatherMap to display relevant weather icons in the popup.</li>
<li>Responsive Design: Ensure the dashboard works well on different screen sizes (mobile, tablet, desktop).</li>
</ul>
<p>Phase 4: Deployment and Testing</p>
<p>Deployment - Frontend (React - using Netlify as an example):</p>
<p>Build your React Frontend:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>cd weather-dashboard-frontend
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>npm run build
</span></code></pre></div>
<p>This creates an optimized production build of your React app in the build folder.</p>
<p>Deploy to Netlify:</p>
<ul>
<li>Sign up for a free Netlify account at https://www.netlify.com/.</li>
<li>Install Netlify CLI globally (optional but recommended for more control): npm install netlify-cli -g.</li>
<li>From your weather-dashboard-frontend directory:</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>netlify deploy --prod
</span></code></pre></div>
<p>(If you don't have Netlify CLI, you can also drag and drop the <code>build</code> folder to the Netlify web interface.)  </p>
<ul>
<li>Netlify will give you a live URL for your frontend.</li>
</ul>
<p>Deployment - Backend (Node.js/Express - using PythonAnywhere as an example):</p>
<p>Prepare for Deployment:</p>
<ul>
<li>Procfile: Create a <code>Procfile</code> in your <code>weather-dashboard-backend</code> folder (no file extension):</li>
</ul>
<p><div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>web: node server.js
</span></code></pre></div>
* package.json (engines): Add an engines section to your package.json to specify the Node.js version:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>&quot;engines&quot;: {
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>    &quot;node&quot;: &quot;18.x&quot;  // Or a specific Node.js version you used
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>},
</span></code></pre></div>
<p>Deploy to PythonAnywhere (Free Tier - suitable for testing, limitations apply):</p>
<ul>
<li>Sign up for a free PythonAnywhere account at https://www.pythonanywhere.com/.</li>
<li>Create a Web App: Go to the "Web" tab and click "Add a new web app." Choose "Manual configuration" and Node.js.</li>
<li>Upload your Backend Code: Use the "Files" tab to upload the contents of your weather-dashboard-backend folder (including <code>package.json</code>, <code>server.js</code>, <code>Procfile</code>, <code>.env</code>). <em>Important: On PythonAnywhere free tier, you may need to manually set environment variables within your web app configuration instead of using a .env file if file access restrictions are in place.</em>  </li>
<li>Install Dependencies: In a PythonAnywhere console (bash), navigate to your backend directory and run npm install.</li>
<li>Configure Web App Settings: In the "Web" tab, ensure your "Working directory" points to your backend directory and that the "WSGI file" (if prompted) is correctly configured (it usually defaults to a basic setup). Make sure to point the "webapp URL" to your <code>server.js</code> or <code>index.js</code> as specified in your <code>Procfile</code>.</li>
</ul>
<p>Deployment - Alternatives:</p>
<ul>
<li>Frontend: Vercel (similar to Netlify, also excellent for React), AWS S3, Google Firebase Hosting, GitHub Pages.  </li>
<li>Backend: Heroku (more robust, often easier for Node.js), Render (another good PaaS), AWS EC2/Elastic Beanstalk, Google Cloud App Engine, DigitalOcean.</li>
</ul>
<p>Testing - Detailed Instructions:</p>
<p>Local Development Testing:</p>
<ul>
<li>Frontend: Test at http://localhost:3000 while running npm start in your frontend.</li>
<li>Backend: Test at http://localhost:5000 (and specific API endpoints) while running <code>node server.js</code> in your backend.</li>
<li>Use browser developer tools (F12 -&gt; Network tab, Console tab) to inspect API requests, responses, and any errors.</li>
<li>Test clicking on different map locations.</li>
</ul>
<p>Deployed Frontend Testing (on Netlify/Vercel):</p>
<ul>
<li>Access your live Netlify/Vercel URL.</li>
<li>Repeat map clicking tests.</li>
<li>Check if the frontend is correctly fetching data from your deployed backend (the URL in axios.get in your frontend needs to point to your deployed backend URL, not localhost:5000 anymore - see "Phase 5: Configuration for Deployment" below).</li>
</ul>
<p>Deployed Backend Testing (on PythonAnywhere/Heroku/Render):</p>
<ul>
<li>Access your deployed backend URL directly (e.g., from PythonAnywhere's web app URL).</li>
<li>Test the <code>/weather</code> endpoint with lat/lon parameters (e.g., <code>your-pythonanywhere-url.pythonanywhere.com/weather?lat=40.7128&amp;lon=-74.0060</code>).</li>
<li>Ensure it returns valid weather data.</li>
</ul>
<p>Cross-Browser Testing:</p>
<p>Test your deployed dashboard on different browsers (Chrome, Firefox, Safari, Edge) and different devices (desktop, mobile, tablet) to ensure compatibility and responsiveness.
Performance Testing (Basic):</p>
<ul>
<li>Use browser developer tools (Network tab -&gt; check "Disable cache" and reload) to measure API request times.</li>
<li>If you have caching implemented, test with and without cache to see performance improvements.</li>
</ul>
<p>Error Handling Testing:</p>
<ul>
<li>Simulate API errors:</li>
<li>Intentionally use an invalid API key in your backend <code>.env</code>.</li>
<li>Temporarily take down your backend server.</li>
<li>Test what happens in the frontend when the API call fails  error messages in popups, graceful handling.</li>
</ul>
<p>User Acceptance Testing (UAT):</p>
<p>Ask other people to use your dashboard and give feedback on usability, functionality, and any issues they encounter.</p>
<p>Phase 5: Configuration for Deployment (Important)</p>
<p>Backend URL in Frontend:  When you deploy, your frontend will need to connect to your deployed backend URL, not http://localhost:5000.</p>
<p>Environment Variables in Frontend: Best practice is to use environment variables in your React frontend as well. Create <code>.env.production</code> and <code>.env.development</code> files in your frontend root.</p>
<p>In <code>.env.development</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>REACT_APP_BACKEND_URL=http://localhost:5000
</span></code></pre></div>
<p>In <code>.env.production</code>:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>REACT_APP_BACKEND_URL=YOUR_DEPLOYED_BACKEND_URL_HERE  // Replace with your actual deployed backend URL
</span></code></pre></div>
<ul>
<li>Access the URL in your React code like this: <code>process.env.REACT_APP_BACKEND_URL</code>.</li>
<li>Netlify/Vercel Environment Variables: When deploying to Netlify or Vercel, you can also set environment variables in their platform settings, which is a more secure way for production.</li>
<li>CORS for Production: For a production setup, you should restrict CORS on your backend to only allow requests from your deployed frontend URL instead of <code>cors()</code>. You can configure cors middleware to allow specific origins.</li>
</ul>
<p>Important Considerations:</p>
<ul>
<li>API Rate Limits: Be mindful of the OpenWeatherMap API free tier rate limits. For more usage, you might need to upgrade to a paid plan or implement caching.</li>
<li>Security: For a production application, you'd need to think more about security:</li>
<li>Securely manage API keys (environment variables, don't expose them in frontend code).</li>
<li>HTTPS for all communication.</li>
<li>Input validation and sanitization.</li>
<li>Consider authentication and authorization if you need to control access.</li>
<li>Scalability: For a highly scalable application, you might choose different backend technologies (like serverless functions or more robust cloud infrastructure) and database solutions.</li>
</ul>
<p>This detailed guide should give you a solid foundation for building and deploying your interactive weather dashboard. Remember to test thoroughly at each stage and iterate based on feedback! Good luck!</p>
</details>
</div>
<p><strong>AI code editors</strong></p>
<p>There are also AI enabled code editors which let you access AI support in the text editor environment where you write code. These tools have a mix of free and paid options:</p>
<ul>
<li><a href="https://code.visualstudio.com/docs/copilot/overview" target="_blank">copilot in Visual Studio Code</a></li>
<li><a href="https://www.cursor.com" target="_blank">Cursor AI</a></li>
<li><a href="https://codeium.com/windsurf" target="_blank">Windsurf</a></li>
</ul>
<h2 id="ai-for-literature-reviews-studying-thinking-and-writing">AI for literature reviews, studying, thinking and writing<a class="headerlink" href="#ai-for-literature-reviews-studying-thinking-and-writing" title="Permanent link">&para;</a></h2>
<p>Before using AI tools to work with literature, its important to be aware of the content's terms of service and the copyright, licensing and privacy implications. You should research the copyright and licensing of any material you upload to and use with AI literature tools. </p>
<div class="admonition tip">
<p class="admonition-title">General guidelines for uploading data to AI tools</p>
<ul>
<li>Check how the AI service provider uses your data (i.e. content you upload and your prompts). If possible, select options and use tools that are not trained on and do not view your data. </li>
<li>Do not share content that you generate with AI tools. Use these tools privately to enhance your studying, thinking and understanding. Rather than using AI tools as text summarisers / generators, use them to be more active in how you engage with literature and as aids to help you practice critical and analytical reading and thinking. </li>
</ul>
</div>
<p><strong>I want to practice critical / analytical reading and thinking</strong> </p>
<p>Look at how the AI tools identify limitations and gaps with existing studies as a template for your own reading AND critique the AI responses too - do you agree with the limitations and gaps the AI has identified?</p>
<ul>
<li>Use  <a href="https://storm.genie.stanford.edu" target="_blank">STORM Genie's</a> CO-STORM feature to generate a round table discussion of a topic. This will generate a discussion of a topic presenting different views and perspectives.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Review STORM and CO-STORM's brainSTORMING process</p>
<p>When generating Wikipedia-like articles or round table discussions STORM undertakes a "brainstorming" process where agents from different perspectives ask and answer questions on a topic, update their knowledge and generate new ideas. Looking at this trace is a good way for you to practice approaching a topic from different perspectives and also identify effective questions that you can reuse elsewhere when researching topics and undertaking literature reviews. </p>
<p><iframe src="https://drive.google.com/file/d/1XnY5QiJw50akczvn7tedEQXFkiVxLKur/preview" width="640" height="480" allow="autoplay"></iframe></p>
<p><em>The STORM interface and viewing the brainSTORMING process.</em></p>
</div>
<ul>
<li>Upload a paper to <a href="https://notebooklm.google.com" target="_blank">NotebookLM</a> and prompt it to generate a list of limitations and recommendations for further work. Or, ask <a href="https://storm.genie.stanford.edu" target="_blank">STORM Genie</a> to create to review the literature and create a list of limitations with the current state of the literature for a topic area or task.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Reviewing lists of knowledge gaps or recommendations for further research</p>
<p>Actively engage with the lists of limitations and recommendations by prioritising them for further study by considering criteria of impact (what benefits will accrue if the limitation is addressed) and feasibility (what is holding back progress in this area? data availability? knowledge? financial resources?).</p>
<p>Also, consider if agree with the limitations and gaps the AI has identified? Are there gaps that you think the AI has overlooked? Why might that be the case?</p>
</div>
<ul>
<li>Ask <a href="https://blog.google/products/gemini/google-gemini-deep-research/" target="_blank">Google Deep Research (costs)</a> or <a href="https://www.perplexity.ai" target="_blank">Perplexity (Deep Research)</a>  to provide a review of knowledge gaps or methodological limitations for a topic area. When reading a paper, consider how it addresses these gaps and identify what its contribution to the literature is. Also, reflect on how relevant the gaps and limitations generated by the AI are. </li>
</ul>
<p><strong>I want to create a background overview of a subject area before reading papers in detail</strong></p>
<p>Generating a literature review prior to reading can help you situate the paper within the broader literature, give you tips to help develop your critical reading and provide you with a background understanding of relevant concepts and theory, which will make your reading more efficient and effective.</p>
<p>Ask <a href="https://storm.genie.stanford.edu" target="_blank">STORM</a>, <a href="https://www.perplexity.ai" target="_blank">Perplexity (Deep Research)</a>, or  <a href="https://blog.google/products/gemini/google-gemini-deep-research/" target="_blank">Google Deep Research (costs)</a> to prepare a subject review (follow up, check and add to the sources used by the AI tool):</p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a literature review on land cover classification methods using remote sensing images?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a literature review on harvest weed seed control?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a review on Western Australian drylands salinity challenges and management practices?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a review of methods to segment field boundaries from satellite images? Can you focus on approaches most suited to smallholder cropping systems?</p>
</div>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a review on methods to classify crop type from remote sensing images? </p>
</div>
<p><strong>I want to create an overview of organisations resources / policies</strong></p>
<p>Ask <a href="https://blog.google/products/gemini/google-gemini-deep-research/" target="_blank">Google Deep Research (costs)</a>, <a href="https://www.perplexity.ai" target="_blank">Perplexity (Deep Research or Pro Search)</a> or <a href="https://chatgpt.com" target="_blank">ChatGPT (with Search and Reason turned on)</a> to complete a web search and generate a report (follow up, check and add to the sources used by the AI tool):</p>
<div class="admonition note">
<p class="admonition-title">Prompt</p>
<p>Can you write a review of the Western Australian Governments Department of Primary Industry and Regional Developments recommendations for constructing farm dams?</p>
</div>
<p><strong>I have 10 minutes and want a quick overview of a paper</strong></p>
<ul>
<li>Upload the paper to <a href="https://notebooklm.google.com" target="_blank">NotebookLM</a> and ask it to create a short podcast conversation about the paper</li>
<li>Upload the paper to <a href="https://notebooklm.google.com" target="_blank">NotebookLM</a> and ask it to generate a study guide / briefing document</li>
<li>Upload the paper to <a href="https://notebooklm.google.com" target="_blank">NotebookLM</a> and ask it to generate a blog-style review of the paper</li>
</ul>
<p><strong>I want to test my understanding of a paper / topic</strong></p>
<ul>
<li>Upload the paper to <a href="https://notebooklm.google.com" target="_blank">NotebookLM</a> and prompt it to generate a study quiz for you</li>
<li>Upload the paper to <a href="https://notebooklm.google.com" target="_blank">NotebookLM</a> and ask it to generate text for a set of Anki cards with answers</li>
</ul>
<p><strong>Im struggling to understand an equation / figure / section of a paper</strong></p>
<ul>
<li>Screen share with <a href="https://aistudio.google.com" target="_blank">Google AI Studio</a> and verbally ask for an explanation of the content that youre stuck with. Keep prompting until you are satisfied with your understanding.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../overview-and-tools/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Using AI for spatial and agricultural data analysis">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Using AI for spatial and agricultural data analysis
              </div>
            </div>
          </a>
        
        
          
          <a href="../prompt-engineering/" class="md-footer__link md-footer__link--next" aria-label="Next: Prompt engineering">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Prompt engineering
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.top", "navigation.footer"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.caa56a14.min.js"></script>
      
    
  </body>
</html>